<?xml version="1.0" encoding="utf-8" standalone="yes"?><rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom" xmlns:media="http://search.yahoo.com/mrss/"><channel><title>Posts on Kenta Arai Webpage</title><link>https://Kenta11.github.io/posts/</link><description>Recent content in Posts on Kenta Arai Webpage</description><generator>Hugo -- 0.143.1</generator><language>en-us</language><lastBuildDate>Fri, 28 Apr 2023 21:30:00 +0900</lastBuildDate><atom:link href="https://Kenta11.github.io/posts/index.xml" rel="self" type="application/rss+xml"/><item><title>Vitis HLS on Ubuntu on Manjaro</title><link>https://Kenta11.github.io/posts/2023-04-27-vitis_hls-on-ubuntu-on-manjaro/</link><pubDate>Fri, 28 Apr 2023 21:30:00 +0900</pubDate><guid>https://Kenta11.github.io/posts/2023-04-27-vitis_hls-on-ubuntu-on-manjaro/</guid><description>&amp;lt;no value&amp;gt;</description><content type="text/html" mode="escaped"><![CDATA[<h2 id="ã¯ã˜ã‚ã«">ã¯ã˜ã‚ã«<a href="#%e3%81%af%e3%81%98%e3%82%81%e3%81%ab" class="anchor" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"
      stroke-linecap="round" stroke-linejoin="round">
      <path d="M15 7h3a5 5 0 0 1 5 5 5 5 0 0 1-5 5h-3m-6 0H6a5 5 0 0 1-5-5 5 5 0 0 1 5-5h3"></path>
      <line x1="8" y1="12" x2="16" y2="12"></line>
   </svg></a></h2>
<p>Manjaro ã§ Vitis HLS ã®<a href="https://github.com/Kenta11/Vitis-HLS-Introductory-Examples">ã‚µãƒ³ãƒ—ãƒ«ãƒ—ãƒ­ã‚°ãƒ©ãƒ </a>ã‚’è©¦ã—ãŸã¨ã“ã‚ï¼ŒCSIM ãŒã§ããªã‹ã£ãŸï¼
ã‚µãƒãƒ¼ãƒˆã•ã‚Œã¦ã„ãªã„ Manjaro ã§è©¦è¡ŒéŒ¯èª¤ã™ã‚‹ã®ã‚‚æ™‚é–“ã®æµªè²»ãªã®ã§ï¼ŒDocker ã§ Ubuntu ã‚³ãƒ³ãƒ†ãƒŠã‚’å‹•ã‹ã—ï¼Œãã“ã§ Vitis HLS ã‚’è©¦ã—ã¦ã¿ã‚‹ã“ã¨ã«ã™ã‚‹ï¼</p>
<h2 id="å‰ææ¡ä»¶">å‰ææ¡ä»¶<a href="#%e5%89%8d%e6%8f%90%e6%9d%a1%e4%bb%b6" class="anchor" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"
      stroke-linecap="round" stroke-linejoin="round">
      <path d="M15 7h3a5 5 0 0 1 5 5 5 5 0 0 1-5 5h-3m-6 0H6a5 5 0 0 1-5-5 5 5 0 0 1 5-5h3"></path>
      <line x1="8" y1="12" x2="16" y2="12"></line>
   </svg></a></h2>
<ul>
<li>Vitis HLS ã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã—ãŸãƒã‚·ãƒ³ä¸Šã§ Docker ã‚’å‹•ä½œã•ã›ã‚‹
<ul>
<li>Ubuntu ã‚³ãƒ³ãƒ†ãƒŠã®ãƒ•ã‚¡ã‚¤ãƒ«ã‚·ã‚¹ãƒ†ãƒ ã§ Vitis ã®ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã‚’ãƒã‚¦ãƒ³ãƒˆã—ï¼ŒVitis ã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã—ãŸ Ubuntu ç’°å¢ƒã‚’æ“¬ä¼¼çš„ã«ç”¨æ„ã™ã‚‹</li>
</ul>
</li>
</ul>
<h2 id="docker-ä¸Šã§-ubuntu-ã‚³ãƒ³ãƒ†ãƒŠã‚’å‹•ä½œã•ã›ã‚‹">Docker ä¸Šã§ Ubuntu ã‚³ãƒ³ãƒ†ãƒŠã‚’å‹•ä½œã•ã›ã‚‹<a href="#docker-%e4%b8%8a%e3%81%a7-ubuntu-%e3%82%b3%e3%83%b3%e3%83%86%e3%83%8a%e3%82%92%e5%8b%95%e4%bd%9c%e3%81%95%e3%81%9b%e3%82%8b" class="anchor" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"
      stroke-linecap="round" stroke-linejoin="round">
      <path d="M15 7h3a5 5 0 0 1 5 5 5 5 0 0 1-5 5h-3m-6 0H6a5 5 0 0 1-5-5 5 5 0 0 1 5-5h3"></path>
      <line x1="8" y1="12" x2="16" y2="12"></line>
   </svg></a></h2>
<p>ä»¥ä¸‹ã® Dockerfile ã‚’æº–å‚™ã™ã‚‹ï¼
<code>apt install</code> ã§ã„ãã¤ã‹ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã™ã‚‹ï¼
ã“ã‚Œã‚‰ã®ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã¯ CSIM ã§å¿…è¦ã«ãªã‚‹ï¼
ã¾ãŸï¼Œç’°å¢ƒå¤‰æ•°<code>LIBRARY_PATH</code>ã‚’å®šç¾©ã—ã¦ã„ã‚‹ãŒï¼Œã“ã‚Œã‚‚ CSIM ã§å¿…è¦ã«ãªã‚‹ï¼</p>
<pre tabindex="0"><code>FROM ubuntu:22.04
LABEL maintainer &#34;Kenta Arai &lt;&gt;&#34;

RUN apt update -y \
  &amp;&amp; apt dist-upgrade -y \
  &amp;&amp; apt autoremove -y \
  &amp;&amp; apt install build-essential gcc-multilib git language-pack-en libc6-dev libtinfo5 -y \
  &amp;&amp; echo &#34;export LIBRARY_PATH=/usr/lib/x86_64-linux-gnu&#34; &gt;&gt; ~/.bashrc
</code></pre><p>æ¬¡ã« Docker ã‚¤ãƒ¡ãƒ¼ã‚¸ã‚’ä½œæˆã—ï¼Œã‚³ãƒ³ãƒ†ãƒŠã‚’ç”Ÿæˆã™ã‚‹ï¼
<code>/opt</code> ä¸‹ã« Vitis ã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã—ãŸãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã‚’ãƒã‚¦ãƒ³ãƒˆã™ã‚‹ï¼</p>
<pre tabindex="0"><code>$ ls
Dockerfile
$ sudo docker buildx build -t ubuntu_22.04_for_vitis .
$ sudo docker run -it --name ubuntu_22.04_for_vitis \
--mount type=bind,src=https://Kenta11.github.io/opt/Xilinx/2022.2,dst=/opt/Xilinx/2022.2,readonly \
ubuntu_22.04_for_vitis /bin/bash
</code></pre><h2 id="ubuntu-ä¸Šã§-vitis-hls-ã‚’å‹•ä½œã•ã›ã‚‹">Ubuntu ä¸Šã§ Vitis HLS ã‚’å‹•ä½œã•ã›ã‚‹<a href="#ubuntu-%e4%b8%8a%e3%81%a7-vitis-hls-%e3%82%92%e5%8b%95%e4%bd%9c%e3%81%95%e3%81%9b%e3%82%8b" class="anchor" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"
      stroke-linecap="round" stroke-linejoin="round">
      <path d="M15 7h3a5 5 0 0 1 5 5 5 5 0 0 1-5 5h-3m-6 0H6a5 5 0 0 1-5-5 5 5 0 0 1 5-5h3"></path>
      <line x1="8" y1="12" x2="16" y2="12"></line>
   </svg></a></h2>
<p>Vitis HLS ã®ã‚µãƒ³ãƒ—ãƒ«ãƒ—ãƒ­ã‚°ãƒ©ãƒ ã‚’ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã—ï¼Œ<code>vitis_hls</code>ã§è«–ç†åˆæˆï¼ŒCSIMï¼ŒCOSIM ã‚’é–‹å§‹ã™ã‚‹ï¼</p>
<pre tabindex="0"><code># cd ~
# git clone https://github.com/Kenta11/Vitis-HLS-Introductory-Examples
# cd Vitis-HLS-Introductory-Examples/Modeling/using_vectors/
# source /opt/Xilinx/2022.2/Vivado/2022.2/settings64.sh
# vitis_hls -f run_hls.tcl
</code></pre><p>è«–ç†åˆæˆã¨ CSIM ã‚’ç„¡äº‹ã«å®Œäº†ã™ã‚‹ã“ã¨ãŒã§ããŸï¼
ãŸã ã— COSIM ã¯é€”ä¸­ã§çµ‚äº†ã—ã¦ã—ã¾ã£ãŸï¼
ä»¥ä¸‹ã¯ COSIM ã®ãƒ­ã‚°ã§ã‚ã‚‹ï¼</p>
<pre tabindex="0"><code>****** xsim v2022.2 (64-bit)
  **** SW Build 3671981 on Fri Oct 14 04:59:54 MDT 2022
  **** IP Build 3669848 on Fri Oct 14 08:30:02 MDT 2022
    ** Copyright 1986-2022 Xilinx, Inc. All Rights Reserved.

source xsim.dir/example/xsim_script.tcl
# xsim {example} -autoloadwcfg -tclbatch {example.tcl}
Time resolution is 1 ps
source example.tcl
## run all
////////////////////////////////////////////////////////////////////////////////////
// Inter-Transaction Progress: Completed Transaction / Total Transaction
// Intra-Transaction Progress: Measured Latency / Latency Estimation * 100%
//
// RTL Simulation : &#34;Inter-Transaction Progress&#34; [&#34;Intra-Transaction Progress&#34;] @ &#34;Simulation Time&#34;
////////////////////////////////////////////////////////////////////////////////////
// RTL Simulation : 0 / 1 [n/a] @ &#34;128000&#34;
// RTL Simulation : 1 / 1 [n/a] @ &#34;2523000&#34;
////////////////////////////////////////////////////////////////////////////////////
$finish called at time : 2552500 ps : File &#34;/root/Vitis-HLS-Introductory-Examples/Modeling/using_vectors/proj_example/solution1/sim/verilog/example.autotb.v&#34; Line 588
## quit
INFO: [Common 17-206] Exiting xsim at Fri Apr 28 12:31:04 2023...
ERROR: [COSIM 212-4] *** C/RTL co-simulation finished: FAIL ***
INFO: [COSIM 212-211] II is measurable only when transaction number is greater than 1 in RTL simulation. Otherwise, they will be marked as all NA. If user wants to calculate them, please make sure there are at least 2 transactions in RTL simulation.
INFO: [HLS 200-111] Finished Command cosim_design CPU user time: 52.13 seconds. CPU system time: 2.92 seconds. Elapsed time: 46.81 seconds; current allocated memory: 9.879 MB.
command &#39;ap_source&#39; returned error code
    while executing
&#34;source run_hls.tcl&#34;
    (&#34;uplevel&#34; body line 1)
    invoked from within
&#34;uplevel \#0 [list source $arg] &#34;

INFO: [HLS 200-112] Total CPU user time: 71.46 seconds. Total CPU system time: 4.64 seconds. Total elapsed time: 78.79 seconds; peak allocated memory: 912.445 MB.
INFO: [Common 17-206] Exiting vitis_hls at Fri Apr 28 12:31:04 2023...
</code></pre><h2 id="ãŠã‚ã‚Šã«">ãŠã‚ã‚Šã«<a href="#%e3%81%8a%e3%82%8f%e3%82%8a%e3%81%ab" class="anchor" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"
      stroke-linecap="round" stroke-linejoin="round">
      <path d="M15 7h3a5 5 0 0 1 5 5 5 5 0 0 1-5 5h-3m-6 0H6a5 5 0 0 1-5-5 5 5 0 0 1 5-5h3"></path>
      <line x1="8" y1="12" x2="16" y2="12"></line>
   </svg></a></h2>
<p>Vitis HLS ã® CSIM ã¯ Manjaro ã§ã¯ã§ããªã‹ã£ãŸãŒï¼ŒDocker ä¸Šã§å‹•ä½œã™ã‚‹ Ubuntu ã‚³ãƒ³ãƒ†ãƒŠã§ã¯ CSIM ã‚’ã™ã‚‹ã“ã¨ãŒã§ããŸï¼
ãŸã ã— COSIM ã¯ã§ããªã‹ã£ãŸï¼
å…¬å¼ã®ã‚µãƒ³ãƒ—ãƒ«ãƒ—ãƒ­ã‚°ãƒ©ãƒ ãªã®ã§ COSIM ãŒã§ããªã„ã¨ã„ã†ã“ã¨ã¯ç„¡ã„ã¨æ€ã„ãŸã„ï¼
ä½™åŠ›ãŒã‚ã‚Œã°åŸå› ã‚’èª¿ã¹ã‚ˆã†ï¼</p>
]]></content></item><item><title>æƒ…å ±å·¥å­¦å®Ÿé¨“IIï¼ˆå†ã€…å±¥ä¿®ï¼‰</title><link>https://Kenta11.github.io/posts/2023-03-18-micro-alpha/</link><pubDate>Sat, 18 Mar 2023 19:00:00 +0900</pubDate><guid>https://Kenta11.github.io/posts/2023-03-18-micro-alpha/</guid><description>&amp;lt;no value&amp;gt;</description><content type="text/html" mode="escaped"><![CDATA[<h2 id="ã¯ã˜ã‚ã«">ã¯ã˜ã‚ã«<a href="#%e3%81%af%e3%81%98%e3%82%81%e3%81%ab" class="anchor" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"
      stroke-linecap="round" stroke-linejoin="round">
      <path d="M15 7h3a5 5 0 0 1 5 5 5 5 0 0 1-5 5h-3m-6 0H6a5 5 0 0 1-5-5 5 5 0 0 1 5-5h3"></path>
      <line x1="8" y1="12" x2="16" y2="12"></line>
   </svg></a></h2>
<p>MICRO-1 ã® FPGA å®Ÿè£…ã‚’ã—ã¾ã—ãŸï¼
æœ€è¿‘ SystemVerilog ã‚’æ›¸ãå§‹ã‚ãŸã“ã¨ã¨ï¼ŒHDL é–‹ç™ºã«ãŠã‘ã‚‹ãƒ†ã‚¹ãƒˆæ‰‹æ³•ã‚’èª¿ã¹ãŸã“ã¨ã§ï¼Œä½•ã‹æˆæœã‚’ä½œã‚ŠãŸããªã£ãŸãŸã‚ã§ã™ï¼</p>
<h2 id="æˆæœ">æˆæœ<a href="#%e6%88%90%e6%9e%9c" class="anchor" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"
      stroke-linecap="round" stroke-linejoin="round">
      <path d="M15 7h3a5 5 0 0 1 5 5 5 5 0 0 1-5 5h-3m-6 0H6a5 5 0 0 1-5-5 5 5 0 0 1 5-5h3"></path>
      <line x1="8" y1="12" x2="16" y2="12"></line>
   </svg></a></h2>
<ul>
<li><a href="https://github.com/Kenta11/micro-alpha">MICRO-alpha</a></li>
</ul>
<h2 id="micro-1-ã¨ã®ç›¸é•ç‚¹">MICRO-1 ã¨ã®ç›¸é•ç‚¹<a href="#micro-1-%e3%81%a8%e3%81%ae%e7%9b%b8%e9%81%95%e7%82%b9" class="anchor" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"
      stroke-linecap="round" stroke-linejoin="round">
      <path d="M15 7h3a5 5 0 0 1 5 5 5 5 0 0 1-5 5h-3m-6 0H6a5 5 0 0 1-5-5 5 5 0 0 1 5-5h3"></path>
      <line x1="8" y1="12" x2="16" y2="12"></line>
   </svg></a></h2>
<p>MICRO-alpha ã¯ MICRO-1 ã§å®Ÿè¡Œã§ãã‚‹åˆ¶å¾¡å‘½ä»¤ã‚’å…¨ã¦ã‚µãƒãƒ¼ãƒˆã—ãŸã®ã§ã™ãŒï¼Œå®Ÿéš›ã«å®Ÿè£…ã™ã‚‹ã«ã‚ãŸã£ã¦ï¼Œè¨­è¨ˆã®ç´°ã‹ãªéƒ¨åˆ†ã‚’å¤‰æ›´ã—ã¾ã—ãŸï¼</p>
<p>æ©Ÿæ¢°èªã®å…¥å‡ºåŠ›å‘½ä»¤ã¯ã‚«ãƒ¼ãƒ‰ãƒªãƒ¼ãƒ€ã¨ãƒ©ã‚¤ãƒ³ãƒ—ãƒªãƒ³ã‚¿ã‚’æ‰±ã†ã®ã§ã™ãŒï¼ŒæµçŸ³ã«ãã‚“ãªã‚‚ã®ã¯èº«ã®å›ã‚Šã«ã‚ã‚Šã¾ã›ã‚“ï¼
ãã“ã§ UART ã‚’ä½¿ã£ãŸã‚·ãƒªã‚¢ãƒ«é€šä¿¡ã§ä»£ç”¨ã—ã¾ã—ãŸï¼</p>
<p>å…¥åŠ›å‘½ä»¤ã¯ R0 ãƒ¬ã‚¸ã‚¹ã‚¿ã«ã‚·ãƒªã‚¢ãƒ«å…¥åŠ›ã‚’æ›¸ãè¾¼ã‚€ã‚ˆã†ã«å¤‰æ›´ã—ã¾ã—ãŸï¼
ãŸã ã—å…¥åŠ›ãŒç„¡ã„å ´åˆãŒæƒ³å®šã•ã‚Œã‚‹ã®ã§ï¼Œãã®å ´åˆã¯ R0 ã‚’ã‚¼ãƒ­ã‚¯ãƒªã‚¢ã—ã¾ã™ï¼
å…¥åŠ›ãŒãªã„ã‚±ãƒ¼ã‚¹ã¯å°‘ãªãã¨ã‚‚ãƒ†ã‚­ã‚¹ãƒˆã§ã¯æƒ³å®šã•ã‚Œã¦ã„ãªã„ã®ã§ï¼Œã‚„ã‚€ã‚’å¾—ãšã“ã®ã‚ˆã†ãªå¯¾å‡¦ã‚’ã—ã¦ã„ã¾ã™ï¼</p>
<p>å‡ºåŠ›å‘½ä»¤ã¯ R0 ãƒ¬ã‚¸ã‚¹ã‚¿ã‚’ã‚·ãƒªã‚¢ãƒ«å‡ºåŠ›ã™ã‚‹ã‚ˆã†ã«å¤‰æ›´ã—ã¾ã—ãŸï¼</p>
<p>ãƒ†ã‚­ã‚¹ãƒˆã§ã¯ï¼Œä¸»è¨˜æ†¶è£…ç½®ãŒã€Œæ¯”è¼ƒçš„å¤§å®¹é‡ã®è¨˜æ†¶è£…ç½®ã§ã‚ã‚‹ã€ã¨æ›¸ã‹ã‚Œã¦ã„ã¾ã™ãŒï¼ŒMICRO-1 ã®ä¸»è¨˜æ†¶è£…ç½®ã¯ç¾ä»£ã®æ„Ÿè¦šã§ã¯ã‹ãªã‚Šå°ã•ã„ï¼ˆ16bit x 64Kï¼‰ã§ã™ï¼
ãªã®ã§ FPGA å®Ÿè£…ã§ã¯ Block RAM ã‚’ä¸»è¨˜æ†¶è£…ç½®ã«å……ã¦ã¾ã—ãŸï¼</p>
<p>ã¾ãŸç´°ã‹ã„ã¨ã“ã‚ã§ã™ãŒï¼Œåˆ¶å¾¡è£…ç½®ã®å‹•ä½œå‘¨æ³¢æ•°ã¯ãƒ†ã‚­ã‚¹ãƒˆã® 20MHz ã§ã¯ãªã 100MHz ã¨ã—ã¾ã—ãŸï¼
ã“ã‚Œã¯å®Ÿè£…ã—ãŸ FPGA ãƒœãƒ¼ãƒ‰ã®ã‚¯ãƒ­ãƒƒã‚¯å…¥åŠ›ã¨åŒã˜å‹•ä½œå‘¨æ³¢æ•°ã«ã—ã¦ã„ã¾ã™ï¼</p>
<h2 id="éŠã³æ–¹">éŠã³æ–¹<a href="#%e9%81%8a%e3%81%b3%e6%96%b9" class="anchor" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"
      stroke-linecap="round" stroke-linejoin="round">
      <path d="M15 7h3a5 5 0 0 1 5 5 5 5 0 0 1-5 5h-3m-6 0H6a5 5 0 0 1-5-5 5 5 0 0 1 5-5h3"></path>
      <line x1="8" y1="12" x2="16" y2="12"></line>
   </svg></a></h2>
<p><strong>ï¼ˆè¿½è¨˜ï¼‰v1.1.4 ã‹ã‚‰ CLI ä¸Šã§ Vivado ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã‚’ä½œæˆã§ãã‚‹ã‚ˆã†ã«ã—ã¾ã—ãŸï¼ v1.1.4 ã§éŠã¶å ´åˆã¯ã€ŒVivado ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã‚’ä½œæˆï¼ˆv1.1.4 ä»¥é™ï¼‰ã€ã‚’å‚ç…§ã—ã¦ãã ã•ã„ï¼</strong></p>
<h3 id="vivado-ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã‚’ä½œæˆv114-ä»¥å‰">Vivado ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã‚’ä½œæˆï¼ˆv1.1.4 ä»¥å‰ï¼‰<a href="#vivado-%e3%83%97%e3%83%ad%e3%82%b8%e3%82%a7%e3%82%af%e3%83%88%e3%82%92%e4%bd%9c%e6%88%90v114-%e4%bb%a5%e5%89%8d" class="anchor" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"
      stroke-linecap="round" stroke-linejoin="round">
      <path d="M15 7h3a5 5 0 0 1 5 5 5 5 0 0 1-5 5h-3m-6 0H6a5 5 0 0 1-5-5 5 5 0 0 1 5-5h3"></path>
      <line x1="8" y1="12" x2="16" y2="12"></line>
   </svg></a></h3>
<p><a href="../2022-09-23-micro1">ä»¥å‰ã®è¨˜äº‹</a>ã§ç´¹ä»‹ã—ãŸãƒ„ãƒ¼ãƒ«ã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã—ãŸãƒã‚·ãƒ³ã§å›è·¯åˆæˆã—ã¾ã™ï¼
<a href="https://github.com/Kenta11/micro-alpha">MICRO-alpha</a>ã®ãƒªãƒã‚¸ãƒˆãƒªã‚’ã‚¯ãƒ­ãƒ¼ãƒ³ã—ã¦ï¼Œãã®ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªå†…ã«ã¦<a href="https://github.com/Kenta11/micro-alpha/releases/tag/v1.0.0">ãƒªãƒªãƒ¼ã‚¹ã®ãƒšãƒ¼ã‚¸</a>ã§å…¬é–‹ã—ã¦ã„ã‚‹ Vivado ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆ (micro-alpha-arty-a7-100.tar.gz) ã‚’è§£å‡ã—ã¾ã™ï¼</p>
<pre tabindex="0"><code>$ git clone https://github.com/Kenta11/micro-alpha
$ cd micro-alpha
$ wget https://github.com/Kenta11/micro-alpha/releases/download/v1.0.0/micro-alpha-arty-a7-100.tar.gz
$ tar zxvf micro-alpha-arty-a7-100.tar.gz
$ tree -L 1
.
â”œâ”€â”€ LICENSE
â”œâ”€â”€ Makefile
â”œâ”€â”€ README.md
â”œâ”€â”€ micro-alpha-arty-a7-100.tar.gz
â”œâ”€â”€ run.py
â”œâ”€â”€ micro-alpha
â”œâ”€â”€ script
â”œâ”€â”€ src
â”œâ”€â”€ tb
</code></pre><p>ãƒã‚¤ã‚¯ãƒ­ãƒ—ãƒ­ã‚°ãƒ©ãƒ ã‚’åˆ¶å¾¡è¨˜æ†¶ã«æ›¸ãè¾¼ã‚€ãŸã‚ã® COE ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ä½œæˆã—ã¾ã™ï¼</p>
<pre tabindex="0"><code>$ curl -s http://www.ced.is.utsunomiya-u.ac.jp/lecture/2022/jikkenb/micro/chap5/MICROONE | iconv -f sjis -t utf8 | tr -d &#34;\32&#34; &gt; MICROONE
$ rm1masm MICROONE -o MICROONE.o
$ python script/obj2coe.py MICROONE.o micro-alpha/micro-alpha.srcs/sources_1/ip/control_memory/control_program.coe
</code></pre><p>ç¶šã„ã¦æ©Ÿæ¢°èªãƒ—ãƒ­ã‚°ãƒ©ãƒ ã‚’åˆ¶å¾¡è¨˜æ†¶ã«æ›¸ãè¾¼ã‚€ãŸã‚ã® COE ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ä½œæˆã—ã¾ã™ï¼</p>
<pre tabindex="0"><code>$ cat calculator 
; This program is distributed under MIT LICENSE.
; Copyright (c) 2023 Kenta Arai

; é€†ãƒãƒ¼ãƒ©ãƒ³ãƒ‰è¨˜æ³•é›»å“ãƒ—ãƒ­ã‚°ãƒ©ãƒ 
; 
; å®Ÿè¡Œä¾‹ï¼ˆ(3+4)*(4-2)ï¼‰
; (CALCULATOR)&gt;&gt; 3 4 + 4 2 - *
; 14
TITLE CALCULATOR
             ORG  140
CALCULATOR0: LA   1, PROMPT
             BSR  PRINT
             LA   1, INPUT
             BSR  RWLINE
             LA   0, INPUT
             BSR  INTERPRET
             BSR  PUTINT
             B    CALCULATOR0
             HLT

; ãƒ‡ãƒ¼ã‚¿é ˜åŸŸ
PROMPT:      DC   &#39; (
             DC   &#39; c
             DC   &#39; a
             DC   &#39; l
             DC   &#39; c
             DC   &#39; )
             DC   &#39; &gt;
             DC   &#39; &gt;
             DC   &#39;  
             DC   0
INPUT:       DS   32

; æ–‡å­—åˆ—ã‚’å‡ºåŠ›è£…ç½®ã«æ›¸ãè¾¼ã‚€é–¢æ•°
; å…¥åŠ›: {r1: æ–‡å­—åˆ—ã®å…ˆé ­ã‚¢ãƒ‰ãƒ¬ã‚¹}
; å‡ºåŠ›: ãªã—
PRINT0:      WIO  LPT
             LEA  1, 1(1)
PRINT:       LX   0, (1)
             OR   0, (0)
             BNZ  PRINT0
             RET

; å…¥åŠ›è£…ç½®ã‹ã‚‰è¡Œã‚’èª­ã‚€é–¢æ•°
; å…¥åŠ›: {r1: è¡Œã®æ›¸è¾¼ã¿å…ˆã‚¢ãƒ‰ãƒ¬ã‚¹}
; å‡ºåŠ›: ãªã—
; NOTE: èª­ã‚“ã æ–‡å­—ã¯éƒ½åº¦å‡ºåŠ›è£…ç½®ã«æ›¸ãè¾¼ã‚€
RWLINE0:     STX  0, (1)
             LEA  1, 1(1)
RWLINE:      BSR  READWORD
             WIO  LPT
             LC   2, X&#34;0D
             CMP  0, (2)
             BNZ  RWLINE0
             WIO  LPT
             LC   0, X&#34;0A
             WIO  LPT
             LC   0, 0
             STX  0, (1)
             RET

; å…¥åŠ›å¼ã‚’è¨ˆç®—ã™ã‚‹
; å…¥åŠ›: {r0: å…¥åŠ›æ–‡å­—åˆ—}
; å‡ºåŠ›: {r1: è¨ˆç®—çµæœ}
INTERPRET:   LX   1, (0)
             CMP  1, 0       ; NULL
             BZ   INTERPRET5
             CMP  1, X&#34;20    ; SP
             BZ   INTERPRET4
             CMP  1, X&#34;2B    ; +
             BNZ  INTERPRET0
             POP  3, 2
             ADD  2, (3)
             PUSH 2, 1
             B    INTERPRET4
INTERPRET0:  CMP  1, X&#34;2D    ; -
             BNZ  INTERPRET1
             POP  3, 2
             SUB  2, (3)
             PUSH 2, 1
             B    INTERPRET4
INTERPRET1:  CMP  1, X&#34;2A    ; *
             BNZ  INTERPRET2
             POP  3, 1
             POP  1, 1
             MULT 1, (3)
             PUSH 2, 1
             B    INTERPRET4
INTERPRET2:  CMP  1, X&#34;2F    ; /
             BNZ  INTERPRET3
             POP  3, 2
             LC   1, 0
             DIV  1, (3)
             PUSH 2, 1
             B    INTERPRET4
INTERPRET3:  BSR  ISDIGIT    ; &#39;0&#39;-&#39;9&#39;
             CMP  1, 0
             BZ   INTERPRET6
             BSR  ATOI
             PUSH 1, 1
INTERPRET4:  ADD  0, 1
             B    INTERPRET
INTERPRET5:  POP  1, 1
INTERPRET6:  RET

; æ•´æ•°ã‚’å‡ºåŠ›è£…ç½®ã«æ›¸ãè¾¼ã‚€é–¢æ•°
; å…¥åŠ›: {r1: æ•°å€¤}
; å‡ºåŠ›: ãªã—
PUTINT:      LC   0, X&#34;30
             WIO  LPT
             LC   0, X&#34;78
             WIO  LPT
             LEA  2, (1)    ; r1[15:12] ã‚’å‡ºï¿½ï¿½ï¿½
             SC   2, 4
             AND  2, X&#34;F
             LA   3, DIGIT
             ADD  2, (3)
             LX   0, (2)
             WIO  LPT
             LEA  2, (1)    ; r1[11:8] ã‚’å‡ºåŠ›
             SC   2, 8
             AND  2, X&#34;F
             LA   3, DIGIT
             ADD  2, (3)
             LX   0, (2)
             WIO  LPT
             LEA  2, (1)    ; r1[7:4] ã‚’å‡ºåŠ›
             SC   2, 12
             AND  2, X&#34;F
             LA   3, DIGIT
             ADD  2, (3)
             LX   0, (2)
             WIO  LPT
             LEA  2, (1)    ; r1[3:0] ã‚’å‡ºåŠ›
             AND  2, X&#34;F
             LA   3, DIGIT
             ADD  2, (3)
             LX   0, (2)
             WIO  LPT
             LC   0, X&#34;0D
             WIO  LPT
             LC   0, X&#34;0A
             WIO  LPT
             RET
DIGIT:       DC   X&#34;30
             DC   X&#34;31
             DC   X&#34;32
             DC   X&#34;33
             DC   X&#34;34
             DC   X&#34;35
             DC   X&#34;36
             DC   X&#34;37
             DC   X&#34;38
             DC   X&#34;39
             DC   X&#34;41
             DC   X&#34;42
             DC   X&#34;43
             DC   X&#34;44
             DC   X&#34;45
             DC   X&#34;46

; å…¥åŠ›è£…ç½®ã‹ã‚‰æ–‡å­—ã‚’èª­ã‚€é–¢æ•°
; å…¥åŠ›: ãªã—
; å‡ºåŠ›: {r0: èª­ã‚“ã æ–‡å­—}
; NOTE: MICRO-alpha ã¯å…¥åŠ›ãŒç„¡ã„å ´åˆã«ãƒŒãƒ«æ–‡å­—ã‚’èª­ã‚“ã æ‰±ã„ã¨ã™ã‚‹
;       ã“ã®é–¢æ•°ã¯ãƒŒãƒ«æ–‡å­—ä»¥å¤–ã‚’èª­ã‚€ã¾ã§ï¼Œå…¥åŠ›è£…ç½®ã‹ã‚‰æ–‡å­—ã‚’èª­ã¿ç¶šã‘ã‚‹
READWORD:    RIO  CR
             OR   0, (0)
             BZ   READWORD
             RET

; å…¥åŠ›æ–‡å­—åˆ—ã‚’æ•°å€¤ã«å¤‰æ›ã™ã‚‹
; å…¥åŠ›: {r0: å…¥åŠ›æ–‡å­—åˆ—}
; å‡ºåŠ›: {r0: å…¥åŠ›æ–‡å­—åˆ—(èª­ã¿é€²ã‚ãŸã‚¢ãƒ‰ãƒ¬ã‚¹), r1: å¤‰æ›å¾Œã®æ•°å€¤}
ATOI:        LC   1, 0
ATOI0:       PUSH 1, 1
             LX   1, (0)
             BSR  ISDIGIT
             CMP  1, 0
             POP  1, 1
             BNZ  ATOI1
             RET
ATOI1:       MULT 1, 10
             LX   1, (0)
             SUB  1, X&#34;30
             ADD  1, (2)
             ADD  0, 1
             B    ATOI0

; å…¥åŠ›æ–‡å­—ãŒæ•°å­—(&#39;0&#39;-&#39;9&#39;)ã§ã‚ã‚‹ã‹ã‚’åˆ¤å®šã™ã‚‹
; å…¥åŠ›: {r1: å…¥åŠ›æ–‡å­—}
; å‡ºåŠ›: {r1: åˆ¤å®šçµæœ(1: æ•°å­—ã§ã‚ã‚‹ï¼Œ0: æ•°å­—ã§ãªã„)}
ISDIGIT:     CMP  1, X&#34;30
             BM   ISDIGIT0
             CMP  1, X&#34;39
             BP   ISDIGIT0
             LC   1, 1
             RET
ISDIGIT0:    LC   1, 0
             RET
END
$ rm1asm calculator -o calculator.b
$ python script/obj2coe.py calculator.b micro-alpha/micro-alpha.srcs/sources_1/ip/main_memory/machine_program.coe
</code></pre><h3 id="vivado-ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã‚’ä½œæˆv114-ä»¥é™">Vivado ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã‚’ä½œæˆï¼ˆv1.1.4 ä»¥é™ï¼‰<a href="#vivado-%e3%83%97%e3%83%ad%e3%82%b8%e3%82%a7%e3%82%af%e3%83%88%e3%82%92%e4%bd%9c%e6%88%90v114-%e4%bb%a5%e9%99%8d" class="anchor" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"
      stroke-linecap="round" stroke-linejoin="round">
      <path d="M15 7h3a5 5 0 0 1 5 5 5 5 0 0 1-5 5h-3m-6 0H6a5 5 0 0 1-5-5 5 5 0 0 1 5-5h3"></path>
      <line x1="8" y1="12" x2="16" y2="12"></line>
   </svg></a></h3>
<ul>
<li><strong>æ³¨æ„ï¼šBasys 3 ã§å‹•ã‹ã™å ´åˆã¯ä»¥ä¸‹ã®ã‚ˆã†ã«èª­ã¿æ›¿ãˆã¦ãã ã•ã„</strong>
<ul>
<li><code>fpga/arty-a7-100/</code> -&gt; <code>fpga/basys-3/</code></li>
<li>Makefile ã®å¤‰æ•° <code>SCRIPT</code> ã‚’ Basys3 ç”¨ã«åˆ‡ã‚Šæ›¿ãˆã‚‹</li>
</ul>
</li>
</ul>
<p><a href="../2022-09-23-micro1">ä»¥å‰ã®è¨˜äº‹</a>ã§ç´¹ä»‹ã—ãŸãƒ„ãƒ¼ãƒ«ã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã—ãŸãƒã‚·ãƒ³ã§å›è·¯åˆæˆã—ã¾ã™ï¼
<a href="https://github.com/Kenta11/micro-alpha">MICRO-alpha</a>ã®ãƒªãƒã‚¸ãƒˆãƒªã‚’ã‚¯ãƒ­ãƒ¼ãƒ³ã—ã¦ãã ã•ã„ï¼</p>
<pre tabindex="0"><code>$ git clone https://github.com/Kenta11/micro-alpha
$ cd micro-alpha
$ tree -L 1
.
â”œâ”€â”€ LICENSE
â”œâ”€â”€ Makefile
â”œâ”€â”€ README.md
â”œâ”€â”€ fpga
â”œâ”€â”€ script
â”œâ”€â”€ src
â””â”€â”€ tb

5 directories, 3 files
</code></pre><p>ãƒã‚¤ã‚¯ãƒ­ãƒ—ãƒ­ã‚°ãƒ©ãƒ ã‚’åˆ¶å¾¡è¨˜æ†¶ã«æ›¸ãè¾¼ã‚€ãŸã‚ã® COE ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ä½œæˆã—ã¾ã™ï¼</p>
<pre tabindex="0"><code>$ curl -s http://www.ced.is.utsunomiya-u.ac.jp/lecture/2022/jikkenb/micro/chap5/MICROONE | iconv -f sjis -t utf8 | tr -d &#34;\32&#34; &gt; MICROONE
$ rm1masm MICROONE -o MICROONE.o
$ python script/obj2coe.py arty-a7-100 MICROONE.o fpga/arty-a7-100/control_program.coe
</code></pre><p>ç¶šã„ã¦ï¼Œæ©Ÿæ¢°èªãƒ—ãƒ­ã‚°ãƒ©ãƒ ã‚’ä¸»è¨˜æ†¶ã«æ›¸ãè¾¼ã‚€ãŸã‚ã® COE ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ä½œæˆã—ã¾ã™ï¼</p>
<pre tabindex="0"><code>$ cat calculator 
; This program is distributed under MIT LICENSE.
; Copyright (c) 2023 Kenta Arai

; é€†ãƒãƒ¼ãƒ©ãƒ³ãƒ‰è¨˜æ³•é›»å“ãƒ—ãƒ­ã‚°ãƒ©ãƒ 
; 
; å®Ÿè¡Œä¾‹ï¼ˆ(3+4)*(4-2)ï¼‰
; (CALCULATOR)&gt;&gt; 3 4 + 4 2 - *
; 14
TITLE CALCULATOR
             ORG  140
CALCULATOR0: LA   1, PROMPT
             BSR  PRINT
             LA   1, INPUT
             BSR  RWLINE
             LA   0, INPUT
             BSR  INTERPRET
             BSR  PUTINT
             B    CALCULATOR0
             HLT

; ãƒ‡ãƒ¼ã‚¿é ˜åŸŸ
PROMPT:      DC   &#39; (
             DC   &#39; c
             DC   &#39; a
             DC   &#39; l
             DC   &#39; c
             DC   &#39; )
             DC   &#39; &gt;
             DC   &#39; &gt;
             DC   &#39;  
             DC   0
INPUT:       DS   32

; æ–‡å­—åˆ—ã‚’å‡ºåŠ›è£…ç½®ã«æ›¸ãè¾¼ã‚€é–¢æ•°
; å…¥åŠ›: {r1: æ–‡å­—åˆ—ã®å…ˆé ­ã‚¢ãƒ‰ãƒ¬ã‚¹}
; å‡ºåŠ›: ãªã—
PRINT0:      WIO  LPT
             LEA  1, 1(1)
PRINT:       LX   0, (1)
             OR   0, (0)
             BNZ  PRINT0
             RET

; å…¥åŠ›è£…ç½®ã‹ã‚‰è¡Œã‚’èª­ã‚€é–¢æ•°
; å…¥åŠ›: {r1: è¡Œã®æ›¸è¾¼ã¿å…ˆã‚¢ãƒ‰ãƒ¬ã‚¹}
; å‡ºåŠ›: ãªã—
; NOTE: èª­ã‚“ã æ–‡å­—ã¯éƒ½åº¦å‡ºåŠ›è£…ç½®ã«æ›¸ãè¾¼ã‚€
RWLINE0:     STX  0, (1)
             LEA  1, 1(1)
RWLINE:      BSR  READWORD
             WIO  LPT
             LC   2, X&#34;0D
             CMP  0, (2)
             BNZ  RWLINE0
             WIO  LPT
             LC   0, X&#34;0A
             WIO  LPT
             LC   0, 0
             STX  0, (1)
             RET

; å…¥åŠ›å¼ã‚’è¨ˆç®—ã™ã‚‹
; å…¥åŠ›: {r0: å…¥åŠ›æ–‡å­—åˆ—}
; å‡ºåŠ›: {r1: è¨ˆç®—çµæœ}
INTERPRET:   LX   1, (0)
             CMP  1, 0       ; NULL
             BZ   INTERPRET5
             CMP  1, X&#34;20    ; SP
             BZ   INTERPRET4
             CMP  1, X&#34;2B    ; +
             BNZ  INTERPRET0
             POP  3, 2
             ADD  2, (3)
             PUSH 2, 1
             B    INTERPRET4
INTERPRET0:  CMP  1, X&#34;2D    ; -
             BNZ  INTERPRET1
             POP  3, 2
             SUB  2, (3)
             PUSH 2, 1
             B    INTERPRET4
INTERPRET1:  CMP  1, X&#34;2A    ; *
             BNZ  INTERPRET2
             POP  3, 1
             POP  1, 1
             MULT 1, (3)
             PUSH 2, 1
             B    INTERPRET4
INTERPRET2:  CMP  1, X&#34;2F    ; /
             BNZ  INTERPRET3
             POP  3, 2
             LC   1, 0
             DIV  1, (3)
             PUSH 2, 1
             B    INTERPRET4
INTERPRET3:  BSR  ISDIGIT    ; &#39;0&#39;-&#39;9&#39;
             CMP  1, 0
             BZ   INTERPRET6
             BSR  ATOI
             PUSH 1, 1
INTERPRET4:  ADD  0, 1
             B    INTERPRET
INTERPRET5:  POP  1, 1
INTERPRET6:  RET

; æ•´æ•°ã‚’å‡ºåŠ›è£…ç½®ã«æ›¸ãè¾¼ã‚€é–¢æ•°
; å…¥åŠ›: {r1: æ•°å€¤}
; å‡ºåŠ›: ãªã—
PUTINT:      LC   0, X&#34;30
             WIO  LPT
             LC   0, X&#34;78
             WIO  LPT
             LEA  2, (1)    ; r1[15:12] ã‚’å‡ºï¿½ï¿½ï¿½
             SC   2, 4
             AND  2, X&#34;F
             LA   3, DIGIT
             ADD  2, (3)
             LX   0, (2)
             WIO  LPT
             LEA  2, (1)    ; r1[11:8] ã‚’å‡ºåŠ›
             SC   2, 8
             AND  2, X&#34;F
             LA   3, DIGIT
             ADD  2, (3)
             LX   0, (2)
             WIO  LPT
             LEA  2, (1)    ; r1[7:4] ã‚’å‡ºåŠ›
             SC   2, 12
             AND  2, X&#34;F
             LA   3, DIGIT
             ADD  2, (3)
             LX   0, (2)
             WIO  LPT
             LEA  2, (1)    ; r1[3:0] ã‚’å‡ºåŠ›
             AND  2, X&#34;F
             LA   3, DIGIT
             ADD  2, (3)
             LX   0, (2)
             WIO  LPT
             LC   0, X&#34;0D
             WIO  LPT
             LC   0, X&#34;0A
             WIO  LPT
             RET
DIGIT:       DC   X&#34;30
             DC   X&#34;31
             DC   X&#34;32
             DC   X&#34;33
             DC   X&#34;34
             DC   X&#34;35
             DC   X&#34;36
             DC   X&#34;37
             DC   X&#34;38
             DC   X&#34;39
             DC   X&#34;41
             DC   X&#34;42
             DC   X&#34;43
             DC   X&#34;44
             DC   X&#34;45
             DC   X&#34;46

; å…¥åŠ›è£…ç½®ã‹ã‚‰æ–‡å­—ã‚’èª­ã‚€é–¢æ•°
; å…¥åŠ›: ãªã—
; å‡ºåŠ›: {r0: èª­ã‚“ã æ–‡å­—}
; NOTE: MICRO-alpha ã¯å…¥åŠ›ãŒç„¡ã„å ´åˆã«ãƒŒãƒ«æ–‡å­—ã‚’èª­ã‚“ã æ‰±ã„ã¨ã™ã‚‹
;       ã“ã®é–¢æ•°ã¯ãƒŒãƒ«æ–‡å­—ä»¥å¤–ã‚’èª­ã‚€ã¾ã§ï¼Œå…¥åŠ›è£…ç½®ã‹ã‚‰æ–‡å­—ã‚’èª­ã¿ç¶šã‘ã‚‹
READWORD:    RIO  CR
             OR   0, (0)
             BZ   READWORD
             RET

; å…¥åŠ›æ–‡å­—åˆ—ã‚’æ•°å€¤ã«å¤‰æ›ã™ã‚‹
; å…¥åŠ›: {r0: å…¥åŠ›æ–‡å­—åˆ—}
; å‡ºåŠ›: {r0: å…¥åŠ›æ–‡å­—åˆ—(èª­ã¿é€²ã‚ãŸã‚¢ãƒ‰ãƒ¬ã‚¹), r1: å¤‰æ›å¾Œã®æ•°å€¤}
ATOI:        LC   1, 0
ATOI0:       PUSH 1, 1
             LX   1, (0)
             BSR  ISDIGIT
             CMP  1, 0
             POP  1, 1
             BNZ  ATOI1
             RET
ATOI1:       MULT 1, 10
             LX   1, (0)
             SUB  1, X&#34;30
             ADD  1, (2)
             ADD  0, 1
             B    ATOI0

; å…¥åŠ›æ–‡å­—ãŒæ•°å­—(&#39;0&#39;-&#39;9&#39;)ã§ã‚ã‚‹ã‹ã‚’åˆ¤å®šã™ã‚‹
; å…¥åŠ›: {r1: å…¥åŠ›æ–‡å­—}
; å‡ºåŠ›: {r1: åˆ¤å®šçµæœ(1: æ•°å­—ã§ã‚ã‚‹ï¼Œ0: æ•°å­—ã§ãªã„)}
ISDIGIT:     CMP  1, X&#34;30
             BM   ISDIGIT0
             CMP  1, X&#34;39
             BP   ISDIGIT0
             LC   1, 1
             RET
ISDIGIT0:    LC   1, 0
             RET
END
$ rm1asm calculator -o calculator.b
$ python script/obj2coe.py arty-a7-100 calculator.b fpga/arty-a7-100/machine_program.coe
</code></pre><p>make ã‚³ãƒãƒ³ãƒ‰ã‚’å®Ÿè¡Œã™ã‚‹ã¨ï¼ŒVivado ã®ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆãŒä½œæˆã•ã‚Œã¾ã™ï¼</p>
<pre tabindex="0"><code>$ make all
$ tree -L 2 vivado
vivado
â””â”€â”€ arty-a7-100
    â”œâ”€â”€ arty-a7-100.cache
    â”œâ”€â”€ arty-a7-100.gen
    â”œâ”€â”€ arty-a7-100.hw
    â”œâ”€â”€ arty-a7-100.ip_user_files
    â”œâ”€â”€ arty-a7-100.srcs
    â””â”€â”€ arty-a7-100.xpr

7 directories, 1 file
</code></pre><h3 id="fpga-ä¸Šã§é€†ãƒãƒ¼ãƒ©ãƒ³ãƒ‰è¨˜æ³•ãƒ—ãƒ­ã‚°ãƒ©ãƒ ã‚’å‹•ä½œã•ã›ã‚‹">FPGA ä¸Šã§é€†ãƒãƒ¼ãƒ©ãƒ³ãƒ‰è¨˜æ³•ãƒ—ãƒ­ã‚°ãƒ©ãƒ ã‚’å‹•ä½œã•ã›ã‚‹<a href="#fpga-%e4%b8%8a%e3%81%a7%e9%80%86%e3%83%9d%e3%83%bc%e3%83%a9%e3%83%b3%e3%83%89%e8%a8%98%e6%b3%95%e3%83%97%e3%83%ad%e3%82%b0%e3%83%a9%e3%83%a0%e3%82%92%e5%8b%95%e4%bd%9c%e3%81%95%e3%81%9b%e3%82%8b" class="anchor" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"
      stroke-linecap="round" stroke-linejoin="round">
      <path d="M15 7h3a5 5 0 0 1 5 5 5 5 0 0 1-5 5h-3m-6 0H6a5 5 0 0 1-5-5 5 5 0 0 1 5-5h3"></path>
      <line x1="8" y1="12" x2="16" y2="12"></line>
   </svg></a></h3>
<p>Vivado ã§å›è·¯ã‚’åˆæˆã—ï¼ŒArty A7-100 ã«æ›¸ãè¾¼ã¿ã¾ã—ã‚‡ã†ï¼
ã‚·ãƒªã‚¢ãƒ«é€šä¿¡ã§ Arty A7-100 ã«ã‚­ãƒ¼ãƒœãƒ¼ãƒ‰å…¥åŠ›ã‚’ã—ã¾ã—ã‚‡ã†ï¼</p>
<pre tabindex="0"><code>$ sudo screen /dev/ttyUSB1 115200
(calc)&gt;&gt; 3 4 + 4 2 - *
0x000E
(calc)&gt;&gt; 
</code></pre><p>é€†ãƒãƒ¼ãƒ©ãƒ³ãƒ‰è¨˜æ³•ã®é›»å“ã§è¨ˆç®—ãŒã§ãã¾ã—ãŸï¼</p>
<h2 id="ãŠã‚ã‚Šã«">ãŠã‚ã‚Šã«<a href="#%e3%81%8a%e3%82%8f%e3%82%8a%e3%81%ab" class="anchor" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"
      stroke-linecap="round" stroke-linejoin="round">
      <path d="M15 7h3a5 5 0 0 1 5 5 5 5 0 0 1-5 5h-3m-6 0H6a5 5 0 0 1-5-5 5 5 0 0 1 5-5h3"></path>
      <line x1="8" y1="12" x2="16" y2="12"></line>
   </svg></a></h2>
<p>ä»Šå¹´åº¦ã¯ MICRO-1 ã§æ•£ã€…éŠã³ã¾ã—ãŸï¼
ã‚‚ã†éŠã³ãŸããªã„ã§ã™ã­ï¼</p>
<p>ä½•ã®å½¹ã«ç«‹ã¤ã®ã‹åˆ†ã‹ã‚‰ãªã„å®Ÿè£…ã§ã™ãŒï¼Œèª°ã‹ã—ã‚‰ã«è²¢çŒ®ã§ããŸã‚‰è‰¯ã„ã§ã™ã­ï¼
ã‚³ãƒ³ãƒ”ãƒ¥ãƒ¼ã‚¿ãƒ»ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£ã®æ­´å²ã‚’å­¦ã¶ä¸Šã§å°‘ã—ã¯å‚è€ƒã«ãªã‚‹ã®ã§ã¯ãªã„ã§ã—ã‚‡ã†ã‹ï¼
ãªã‚‹ã®ã‹ï¼Ÿ
ãªã‚‰ãªãã†ï¼</p>
]]></content></item><item><title>Operating System development tutorials in Rust on the Raspberry Pi ã‚’ã™ã‚‹ #5</title><link>https://Kenta11.github.io/posts/2023-02-13-rust-raspberrypi-os-tutorials/</link><pubDate>Mon, 13 Feb 2023 23:00:00 +0900</pubDate><guid>https://Kenta11.github.io/posts/2023-02-13-rust-raspberrypi-os-tutorials/</guid><description>&amp;lt;no value&amp;gt;</description><content type="text/html" mode="escaped"><![CDATA[<h1 id="ã¯ã˜ã‚ã«">ã¯ã˜ã‚ã«<a href="#%e3%81%af%e3%81%98%e3%82%81%e3%81%ab" class="anchor" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"
      stroke-linecap="round" stroke-linejoin="round">
      <path d="M15 7h3a5 5 0 0 1 5 5 5 5 0 0 1-5 5h-3m-6 0H6a5 5 0 0 1-5-5 5 5 0 0 1 5-5h3"></path>
      <line x1="8" y1="12" x2="16" y2="12"></line>
   </svg></a></h1>
<p><a href="../2023-02-02-rust-raspberrypi-os-tutorials">å‰å›</a>ã®ç¶šãã‹ã‚‰ï¼</p>
<h1 id="05_drivers_gpio_uarthttpsgithubcomrust-embeddedrust-raspberrypi-os-tutorialstreemaster05_drivers_gpio_uart"><a href="https://github.com/rust-embedded/rust-raspberrypi-OS-tutorials/tree/master/05_drivers_gpio_uart">05_drivers_gpio_uart</a><a href="#05_drivers_gpio_uarthttpsgithubcomrust-embeddedrust-raspberrypi-os-tutorialstreemaster05_drivers_gpio_uart" class="anchor" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"
      stroke-linecap="round" stroke-linejoin="round">
      <path d="M15 7h3a5 5 0 0 1 5 5 5 5 0 0 1-5 5h-3m-6 0H6a5 5 0 0 1-5-5 5 5 0 0 1 5-5h3"></path>
      <line x1="8" y1="12" x2="16" y2="12"></line>
   </svg></a></h1>
<h2 id="æ¦‚è¦">æ¦‚è¦<a href="#%e6%a6%82%e8%a6%81" class="anchor" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"
      stroke-linecap="round" stroke-linejoin="round">
      <path d="M15 7h3a5 5 0 0 1 5 5 5 5 0 0 1-5 5h-3m-6 0H6a5 5 0 0 1-5-5 5 5 0 0 1 5-5h3"></path>
      <line x1="8" y1="12" x2="16" y2="12"></line>
   </svg></a></h2>
<ul>
<li>UART ã¨ GPIO ã®ã‚³ãƒ³ãƒˆãƒ­ãƒ¼ãƒ©ç”¨ãƒ‰ãƒ©ã‚¤ãƒã‚’è¿½åŠ ã™ã‚‹
<ul>
<li>ã“ã‚Œã¾ã§ã«ä½œæˆã—ãŸ QEMU ã‚³ãƒ³ã‚½ãƒ¼ãƒ«ã‚’æ¨ã¦ã¦ï¼Œ <code>ãƒ‰ãƒ©ã‚¤ãƒãƒãƒãƒ¼ã‚¸ãƒ£</code> ã‚’å°å…¥ã™ã‚‹</li>
</ul>
</li>
</ul>
<h2 id="ãƒ‰ãƒ©ã‚¤ãƒãƒãƒãƒ¼ã‚¸ãƒ£">ãƒ‰ãƒ©ã‚¤ãƒãƒãƒãƒ¼ã‚¸ãƒ£<a href="#%e3%83%89%e3%83%a9%e3%82%a4%e3%83%90%e3%83%9e%e3%83%8d%e3%83%bc%e3%82%b8%e3%83%a3" class="anchor" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"
      stroke-linecap="round" stroke-linejoin="round">
      <path d="M15 7h3a5 5 0 0 1 5 5 5 5 0 0 1-5 5h-3m-6 0H6a5 5 0 0 1-5-5 5 5 0 0 1 5-5h3"></path>
      <line x1="8" y1="12" x2="16" y2="12"></line>
   </svg></a></h2>
<ul>
<li>
<p><code>ãƒ‰ãƒ©ã‚¤ãƒã‚µãƒ–ã‚·ã‚¹ãƒ†ãƒ </code> ã‚’ã‚«ãƒ¼ãƒãƒ«ã«è¿½åŠ </p>
<ul>
<li>å‚ç…§ï¼š<code>src/driver.rs</code></li>
</ul>
</li>
<li>
<p><code>interface::DeviceDriver</code> ãƒˆãƒ¬ã‚¤ãƒˆã¯å„ãƒ‡ãƒã‚¤ã‚¹ãƒ‰ãƒ©ã‚¤ãƒãŒå®Ÿè£…ã™ã‚‹å¿…è¦ãŒã‚ã‚‹</p>
</li>
<li>
<p><code>crate::driver::driver_manager().init_drivers(...)</code> ã¯ãƒ‰ãƒ©ã‚¤ãƒãƒãƒãƒ¼ã‚¸ãƒ£ã«å…¨ã¦ã®ç™»éŒ²æ¸ˆã¿ãƒ‰ãƒ©ã‚¤ãƒã‚’ãƒ«ãƒ¼ãƒ—ã•ã›ï¼ŒåˆæœŸåŒ–ã‚’ã‚­ãƒƒã‚¯ã—ï¼Œã‚ªãƒ—ã‚·ãƒ§ãƒ³ã® <code>åˆæœŸåŒ–å¾Œã‚³ãƒ¼ãƒ«ãƒãƒƒã‚¯</code> ã‚‚å®Ÿè¡Œã™ã‚‹</p>
</li>
</ul>
<h2 id="bsp-ãƒ‰ãƒ©ã‚¤ãƒå®Ÿè£…">BSP ãƒ‰ãƒ©ã‚¤ãƒå®Ÿè£…<a href="#bsp-%e3%83%89%e3%83%a9%e3%82%a4%e3%83%90%e5%ae%9f%e8%a3%85" class="anchor" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"
      stroke-linecap="round" stroke-linejoin="round">
      <path d="M15 7h3a5 5 0 0 1 5 5 5 5 0 0 1-5 5h-3m-6 0H6a5 5 0 0 1-5-5 5 5 0 0 1 5-5h3"></path>
      <line x1="8" y1="12" x2="16" y2="12"></line>
   </svg></a></h2>
<ul>
<li>
<p><code>src/bsp/raspberrypi/driver.rs</code> ã® <code>init()</code> ãŒ <code>UART</code> ã¨ <code>GPIO</code> ã®ç™»éŒ²ã®é¢å€’ã‚’ã¿ã‚‹</p>
</li>
<li>
<p>ãƒ‰ãƒ©ã‚¤ãƒã¯ <code>src/bsp/device_driver</code> ã«ä¿å­˜ã•ã‚Œã¦ãŠã‚Šï¼Œ<code>BSP</code> ãŒä½¿ç”¨ã™ã‚‹</p>
</li>
<li>
<p>ã¾ãš <code>PL011Uart</code> ãƒ‰ãƒ©ã‚¤ãƒã‚’è¿½åŠ ã™ã‚‹</p>
<ul>
<li><code>console::interface::*</code> ãƒˆãƒ¬ã‚¤ãƒˆã‚’å®Ÿè£…</li>
<li>ãƒ¡ã‚¤ãƒ³ã‚·ã‚¹ãƒ†ãƒ ã®ã‚³ãƒ³ã‚½ãƒ¼ãƒ«ã¨ã—ã¦ä½¿ç”¨</li>
</ul>
</li>
<li>
<p>æ¬¡ã« <code>GPIO</code> ãƒ‰ãƒ©ã‚¤ãƒã‚’è¿½åŠ ã™ã‚‹</p>
<ul>
<li>ã“ã®ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã§ã¯ Raspberry Pi 3 å‘ã‘ã« <code>Makefile</code> ãŒæ›¸ã‹ã‚Œã¦ã„ã‚‹</li>
<li>Raspberry Pi 4 å‘ã‘ã«ãƒ“ãƒ«ãƒ‰ã™ã‚‹å ´åˆã¯ ã‚¿ãƒ¼ã‚²ãƒƒãƒˆã« <code>BSP=rpi4</code> ã‚’æŒ‡å®š
<ul>
<li>Raspberry Pi 3 ã—ã‹æŒã£ã¦ã„ãªã„ã®ã§èª­ã¿é£›ã°ã™</li>
</ul>
</li>
</ul>
</li>
<li>
<p><code>BSP</code> ã¯ <code>src/bsp/raspberrypi/memory.rs</code> ã§ãƒ¡ãƒ¢ãƒªãƒãƒƒãƒ—ã‚’ã‚‚ã¤</p>
</li>
</ul>
<h2 id="sd-ã‚«ãƒ¼ãƒ‰ã‹ã‚‰ãƒ–ãƒ¼ãƒˆã™ã‚‹">SD ã‚«ãƒ¼ãƒ‰ã‹ã‚‰ãƒ–ãƒ¼ãƒˆã™ã‚‹<a href="#sd-%e3%82%ab%e3%83%bc%e3%83%89%e3%81%8b%e3%82%89%e3%83%96%e3%83%bc%e3%83%88%e3%81%99%e3%82%8b" class="anchor" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"
      stroke-linecap="round" stroke-linejoin="round">
      <path d="M15 7h3a5 5 0 0 1 5 5 5 5 0 0 1-5 5h-3m-6 0H6a5 5 0 0 1-5-5 5 5 0 0 1 5-5h3"></path>
      <line x1="8" y1="12" x2="16" y2="12"></line>
   </svg></a></h2>
<ol>
<li><code>boot</code> ã¨ã„ã†åå‰ã® <code>FAT32</code> ã®ãƒ‘ãƒ¼ãƒ†ã‚£ã‚·ãƒ§ãƒ³ã‚’ä½œæˆ</li>
<li>æ‰€å®šã®å†…å®¹ã® <code>config.txt</code> ã‚’ä½œæˆ</li>
<li><a href="https://github.com/raspberrypi/firmware/tree/master/ot">Raspberry Pi firmware repo</a> ã‹ã‚‰ <a href="https://github.com/raspberrypi/firmware/raw/master/boot/otcode.bin">bootcode.bin</a>, <a href="https://github.com/raspberrypi/firmware/raw/master/boot/xup.dat">fixup.dat</a>, <a href="https://github.com/raspberrypi/firmware/raw/master/boot/start.f">start.elf</a> ã‚’ã‚³ãƒ”ãƒ¼</li>
<li><code>make</code> ã‚’å®Ÿè¡Œ</li>
<li><code>kernel8.img</code> ã‚’SDã‚«ãƒ¼ãƒ‰ã«ã‚³ãƒ”ãƒ¼ã—ï¼ŒRaspberry Pi ã«æŒ¿å…¥</li>
<li>ã‚·ãƒªã‚¢ãƒ«é€šä¿¡ç«¯æœ«ã§ <code>UART</code> ã¨æ¥ç¶š</li>
<li>USB ã‚·ãƒªã‚¢ãƒ«ã¨ãƒ›ã‚¹ãƒˆPCã‚’æ¥ç¶š</li>
<li>Raspberry Pi ã‚’é›»æºã«æ¥ç¶šã—ï¼Œå‡ºåŠ›ã‚’è¦³å¯Ÿã™ã‚‹</li>
</ol>
<h2 id="å®Ÿè¡Œçµæœ">å®Ÿè¡Œçµæœ<a href="#%e5%ae%9f%e8%a1%8c%e7%b5%90%e6%9e%9c" class="anchor" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"
      stroke-linecap="round" stroke-linejoin="round">
      <path d="M15 7h3a5 5 0 0 1 5 5 5 5 0 0 1-5 5h-3m-6 0H6a5 5 0 0 1-5-5 5 5 0 0 1 5-5h3"></path>
      <line x1="8" y1="12" x2="16" y2="12"></line>
   </svg></a></h2>
<pre tabindex="0"><code>$ make

Compiling kernel ELF - rpi3
   Compiling mingo v0.5.0 (/home/kenta/Git/Kenta11/rust-raspberrypi-OS-tutorials/05_drivers_gpio_uart)
   Compiling tock-registers v0.8.1
   Compiling aarch64-cpu v9.0.0
    Finished release [optimized] target(s) in 1.83s

Generating stripped binary
        Name kernel8.img
        Size 10 KiB
$ sudo make qemu
[sudo] kenta ã®ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰:

Launching QEMU
[0] mingo version 0.5.0
[1] Booting on: Raspberry Pi 3
[2] Drivers loaded:
      1. BCM PL011 UART
      2. BCM GPIO
[3] Chars written: 117
[4] Echoing input now
</code></pre>]]></content></item><item><title>Operating System development tutorials in Rust on the Raspberry Pi ã‚’ã™ã‚‹ #4</title><link>https://Kenta11.github.io/posts/2023-02-02-rust-raspberrypi-os-tutorials/</link><pubDate>Thu, 02 Feb 2023 21:00:00 +0900</pubDate><guid>https://Kenta11.github.io/posts/2023-02-02-rust-raspberrypi-os-tutorials/</guid><description>&amp;lt;no value&amp;gt;</description><content type="text/html" mode="escaped"><![CDATA[<h1 id="ã¯ã˜ã‚ã«">ã¯ã˜ã‚ã«<a href="#%e3%81%af%e3%81%98%e3%82%81%e3%81%ab" class="anchor" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"
      stroke-linecap="round" stroke-linejoin="round">
      <path d="M15 7h3a5 5 0 0 1 5 5 5 5 0 0 1-5 5h-3m-6 0H6a5 5 0 0 1-5-5 5 5 0 0 1 5-5h3"></path>
      <line x1="8" y1="12" x2="16" y2="12"></line>
   </svg></a></h1>
<p><a href="../2023-02-01-rust-raspberrypi-os-tutorials">å‰å›</a>ã®ç¶šãã‹ã‚‰ï¼</p>
<h1 id="04_safe_globalshttpsgithubcomrust-embeddedrust-raspberrypi-os-tutorialstreemaster04_safe_globals"><a href="https://github.com/rust-embedded/rust-raspberrypi-OS-tutorials/tree/master/04_safe_globals">04_safe_globals</a><a href="#04_safe_globalshttpsgithubcomrust-embeddedrust-raspberrypi-os-tutorialstreemaster04_safe_globals" class="anchor" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"
      stroke-linecap="round" stroke-linejoin="round">
      <path d="M15 7h3a5 5 0 0 1 5 5 5 5 0 0 1-5 5h-3m-6 0H6a5 5 0 0 1-5-5 5 5 0 0 1 5-5h3"></path>
      <line x1="8" y1="12" x2="16" y2="12"></line>
   </svg></a></h1>
<h2 id="æ¦‚è¦">æ¦‚è¦<a href="#%e6%a6%82%e8%a6%81" class="anchor" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"
      stroke-linecap="round" stroke-linejoin="round">
      <path d="M15 7h3a5 5 0 0 1 5 5 5 5 0 0 1-5 5h-3m-6 0H6a5 5 0 0 1-5-5 5 5 0 0 1 5-5h3"></path>
      <line x1="8" y1="12" x2="16" y2="12"></line>
   </svg></a></h2>
<ul>
<li>
<p>ç–‘ä¼¼ãƒ­ãƒƒã‚¯ã‚’å°å…¥ã™ã‚‹è©±</p>
</li>
<li>
<p>global data structure ã«å¯¾ã—ã¦å®‰å…¨ã«ã‚¢ã‚¯ã‚»ã‚¹ã™ã‚‹ãŸã‚ã® OS åŒæœŸãƒ—ãƒªãƒŸãƒ†ã‚£ãƒ–ã® showcaseï¼ˆã‚·ãƒ§ãƒ¼ã‚±ãƒ¼ã‚¹ã£ã¦ãªã‚“ã ã‚ã†ï¼‰</p>
</li>
<li>
<p>safe Rust ã§ã¯ <code>static mut</code> ãªã‚°ãƒ­ãƒ¼ãƒãƒ«å¤‰æ•°ã‚’å®šç¾©ã§ããªã„ã®ã§ï¼Œã“ã®ç« ã§æ’ä»–åˆ¶å¾¡ã®æ©Ÿèƒ½ã‚’å°å…¥ã—ï¼Œå¤‰æ›´å¯èƒ½ãªã‚°ãƒ­ãƒ¼ãƒãƒ«å¤‰æ•°ã‚’å®Ÿç¾ã™ã‚‹</p>
</li>
</ul>
<h2 id="å®Ÿè¡Œçµæœ">å®Ÿè¡Œçµæœ<a href="#%e5%ae%9f%e8%a1%8c%e7%b5%90%e6%9e%9c" class="anchor" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"
      stroke-linecap="round" stroke-linejoin="round">
      <path d="M15 7h3a5 5 0 0 1 5 5 5 5 0 0 1-5 5h-3m-6 0H6a5 5 0 0 1-5-5 5 5 0 0 1 5-5h3"></path>
      <line x1="8" y1="12" x2="16" y2="12"></line>
   </svg></a></h2>
<pre tabindex="0"><code>$ make

Compiling kernel ELF - rpi3
   Compiling mingo v0.4.0 (/home/kenta/Git/Kenta11/rust-raspberrypi-OS-tutorials/04_safe_globals)
   Compiling tock-registers v0.8.1
   Compiling aarch64-cpu v9.0.0
    Finished release [optimized] target(s) in 6.09s

Generating stripped binary
        Name kernel8.img
        Size 7 KiB
$ sudo make test
[sudo] kenta ã®ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰:

Boot test - rpi3
         -------------------------------------------------------------------
         ğŸ¦€ Running 1 console I/O tests
         -------------------------------------------------------------------

           1. Checking for the string: &#39;Stopping here&#39;..................[ok]
         
         Console log:
           [0] Hello from Rust!
           [1] Chars written: 22
           [2] Stopping here

         -------------------------------------------------------------------
         âœ… Success: Boot test
         -------------------------------------------------------------------

$ sudo make qemu

Launching QEMU
[0] Hello from Rust!
[1] Chars written: 22
[2] Stopping here.
</code></pre>]]></content></item><item><title>Operating System development tutorials in Rust on the Raspberry Pi ã‚’ã™ã‚‹ #3</title><link>https://Kenta11.github.io/posts/2023-02-01-rust-raspberrypi-os-tutorials/</link><pubDate>Wed, 01 Feb 2023 22:52:52 +0900</pubDate><guid>https://Kenta11.github.io/posts/2023-02-01-rust-raspberrypi-os-tutorials/</guid><description>&amp;lt;no value&amp;gt;</description><content type="text/html" mode="escaped"><![CDATA[<h1 id="ã¯ã˜ã‚ã«">ã¯ã˜ã‚ã«<a href="#%e3%81%af%e3%81%98%e3%82%81%e3%81%ab" class="anchor" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"
      stroke-linecap="round" stroke-linejoin="round">
      <path d="M15 7h3a5 5 0 0 1 5 5 5 5 0 0 1-5 5h-3m-6 0H6a5 5 0 0 1-5-5 5 5 0 0 1 5-5h3"></path>
      <line x1="8" y1="12" x2="16" y2="12"></line>
   </svg></a></h1>
<p><a href="../2023-01-31-rust-raspberrypi-os-tutorials">å‰å›</a>ã®ç¶šãã‹ã‚‰ï¼</p>
<h1 id="03_hacky_hello_worldhttpsgithubcomrust-embeddedrust-raspberrypi-os-tutorialstreemaster03_hacky_hello_world"><a href="https://github.com/rust-embedded/rust-raspberrypi-OS-tutorials/tree/master/03_hacky_hello_world">03_hacky_hello_world</a><a href="#03_hacky_hello_worldhttpsgithubcomrust-embeddedrust-raspberrypi-os-tutorialstreemaster03_hacky_hello_world" class="anchor" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"
      stroke-linecap="round" stroke-linejoin="round">
      <path d="M15 7h3a5 5 0 0 1 5 5 5 5 0 0 1-5 5h-3m-6 0H6a5 5 0 0 1-5-5 5 5 0 0 1 5-5h3"></path>
      <line x1="8" y1="12" x2="16" y2="12"></line>
   </svg></a></h1>
<ul>
<li>QEMU ãŒã‚¨ãƒŸãƒ¥ãƒ¬ãƒ¼ãƒˆã™ã‚‹ UART ã‚’ä»‹ã—ã¦ï¼Œ<code>println!</code> ãƒã‚¯ãƒ­ã§æ–‡å­—åˆ—ã‚’è¡¨ç¤ºã§ãã‚‹ã‚ˆã†ã«ã™ã‚‹
<ul>
<li><code>console::console</code> é–¢æ•°ã¯ <code>core::fmt::Write</code> ãƒˆãƒ¬ã‚¤ãƒˆã‚’å®Ÿè£…ã—ãŸæ§‹é€ ä½“ã‚’è¿”ã™ (<code>src/bsp/raspberrypi.rs</code>)
<ul>
<li>ã“ã®ãƒˆãƒ¬ã‚¤ãƒˆã¯ <code>write_str</code>, <code>write_char</code>, <code>write_fmt</code> é–¢æ•°ã‚’ã‚‚ã¤</li>
</ul>
</li>
<li><code>write_str</code> é–¢æ•°ã¯ UARTï¼ˆã‚¢ãƒ‰ãƒ¬ã‚¹ãŒ0x3F201000ï¼‰ã«ä¸€æ–‡å­—ãšã¤æ›¸ãè¾¼ã‚€ (<code>src/console.rs</code>)</li>
<li><code>print!</code> ã¨ <code>println!</code> ã¯ãã‚Œãã‚Œ <code>write_fmt</code> é–¢æ•°ã‚’å‘¼ã³å‡ºã™ï¼ˆ<code>src/print.rs</code>ï¼‰
<ul>
<li><code>write_str</code> ã‚’å®Ÿè£…ã™ã‚‹ã¨ <code>write_fmt</code> ã‚‚è‡ªå‹•çš„ã«å®Ÿè£…ã•ã‚Œã‚‹ã®ã‹ï¼Ÿ</li>
</ul>
</li>
</ul>
</li>
</ul>
<h2 id="å®Ÿè¡Œçµæœ">å®Ÿè¡Œçµæœ<a href="#%e5%ae%9f%e8%a1%8c%e7%b5%90%e6%9e%9c" class="anchor" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"
      stroke-linecap="round" stroke-linejoin="round">
      <path d="M15 7h3a5 5 0 0 1 5 5 5 5 0 0 1-5 5h-3m-6 0H6a5 5 0 0 1-5-5 5 5 0 0 1 5-5h3"></path>
      <line x1="8" y1="12" x2="16" y2="12"></line>
   </svg></a></h2>
<pre tabindex="0"><code>$ make

Compiling kernel ELF - rpi3
   Compiling tock-registers v0.8.1
   Compiling mingo v0.3.0 (/home/kenta/Git/Kenta11/rust-raspberrypi-OS-tutorials/03_hacky_hello_world)
   Compiling aarch64-cpu v9.0.0
    Finished release [optimized] target(s) in 3.88s

Generating stripped binary
        Name kernel8.img
        Size 6 KiB
$ make test

Boot test - rpi3
docker: Got permission denied while trying to connect to the Docker daemon socket at unix:///var/run/docker.sock: Post &#34;http://%2Fvar%2Frun%2Fdocker.sock/v1.24/containers/create&#34;: dial unix /var/run/docker.sock: connect: permission denied.
See &#39;docker run --help&#39;.
make: *** [Makefile:216: test_boot] ã‚¨ãƒ©ãƒ¼ 126
$ sudo make test
[sudo] kenta ã®ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰:

Boot test - rpi3
         -------------------------------------------------------------------
         ğŸ¦€ Running 1 console I/O tests
         -------------------------------------------------------------------

           1. Checking for the string: &#39;Stopping here&#39;..................[ok]
         
         Console log:
           Hello from Rust!
           Kernel panic!
           
           Panic location:
                 File &#39;src/main.rs&#39;, line 129, column 5
           
           Stopping here

         -------------------------------------------------------------------
         âœ… Success: Boot test
         -------------------------------------------------------------------


$ sudo make qemu

Launching QEMU
Hello from Rust!
Kernel panic!

Panic location:
      File &#39;src/main.rs&#39;, line 129, column 5

Stopping here.
</code></pre>]]></content></item><item><title>Operating System development tutorials in Rust on the Raspberry Pi ã‚’ã™ã‚‹ #2</title><link>https://Kenta11.github.io/posts/2023-01-31-rust-raspberrypi-os-tutorials/</link><pubDate>Tue, 31 Jan 2023 22:17:41 +0900</pubDate><guid>https://Kenta11.github.io/posts/2023-01-31-rust-raspberrypi-os-tutorials/</guid><description>&amp;lt;no value&amp;gt;</description><content type="text/html" mode="escaped"><![CDATA[<h1 id="ã¯ã˜ã‚ã«">ã¯ã˜ã‚ã«<a href="#%e3%81%af%e3%81%98%e3%82%81%e3%81%ab" class="anchor" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"
      stroke-linecap="round" stroke-linejoin="round">
      <path d="M15 7h3a5 5 0 0 1 5 5 5 5 0 0 1-5 5h-3m-6 0H6a5 5 0 0 1-5-5 5 5 0 0 1 5-5h3"></path>
      <line x1="8" y1="12" x2="16" y2="12"></line>
   </svg></a></h1>
<p><a href="../2023-01-30-rust-raspberrypi-os-tutorials">å‰å›</a>ã®ç¶šãã‹ã‚‰ï¼</p>
<h1 id="02_runtime_inithttpsgithubcomrust-embeddedrust-raspberrypi-os-tutorialstreemaster02_runtime_init"><a href="https://github.com/rust-embedded/rust-raspberrypi-OS-tutorials/tree/master/02_runtime_init">02_runtime_init</a><a href="#02_runtime_inithttpsgithubcomrust-embeddedrust-raspberrypi-os-tutorialstreemaster02_runtime_init" class="anchor" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"
      stroke-linecap="round" stroke-linejoin="round">
      <path d="M15 7h3a5 5 0 0 1 5 5 5 5 0 0 1-5 5h-3m-6 0H6a5 5 0 0 1-5-5 5 5 0 0 1 5-5h3"></path>
      <line x1="8" y1="12" x2="16" y2="12"></line>
   </svg></a></h1>
<ul>
<li><code>_start</code> ã§ä¸»è¨˜æ†¶ã®åˆæœŸåŒ–ã‚’è¡Œã†</li>
<li>åˆæœŸåŒ–å¾Œã« <code>_start_rust</code>ï¼ˆ<code>src/_arch/aarch64/cpu/boot.rs</code>ï¼‰ã«ã‚¨ãƒ³ãƒˆãƒªã—ï¼Œ<code>kernel_init</code>ï¼ˆ<code>src/main.rs</code>ï¼‰ã‚’å®Ÿè¡Œã™ã‚‹</li>
</ul>
<h2 id="ã‚»ã‚¯ã‚·ãƒ§ãƒ³ã®æ§‹æˆ">ã‚»ã‚¯ã‚·ãƒ§ãƒ³ã®æ§‹æˆ<a href="#%e3%82%bb%e3%82%af%e3%82%b7%e3%83%a7%e3%83%b3%e3%81%ae%e6%a7%8b%e6%88%90" class="anchor" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"
      stroke-linecap="round" stroke-linejoin="round">
      <path d="M15 7h3a5 5 0 0 1 5 5 5 5 0 0 1-5 5h-3m-6 0H6a5 5 0 0 1-5-5 5 5 0 0 1 5-5h3"></path>
      <line x1="8" y1="12" x2="16" y2="12"></line>
   </svg></a></h2>
<ul>
<li>
<p>DRAM ã®å…ˆé ­ã‚¢ãƒ‰ãƒ¬ã‚¹ã¯ 0x80000</p>
</li>
<li>
<p>ä»¥ä¸‹ï¼Œãƒªãƒ³ã‚«ã‚¹ã‚¯ãƒªãƒ—ãƒˆã§æŒ‡å®šã•ã‚Œã¦ã„ã‚‹ã‚»ã‚¯ã‚·ãƒ§ãƒ³</p>
</li>
<li>
<p>.boot_core_stackï¼šboot ç”¨ã®ã‚¹ã‚¿ãƒƒã‚¯ï¼Ÿ</p>
</li>
<li>
<p>.textï¼šæ©Ÿæ¢°èªå‘½ä»¤åˆ—</p>
</li>
<li>
<p>.rodataï¼šread-only ãƒ‡ãƒ¼ã‚¿ï¼8ãƒã‚¤ãƒˆã‚¢ãƒ©ã‚¤ãƒ³ã•ã‚Œã¦ã„ã‚‹ï¼</p>
</li>
<li>
<p>.dataï¼šèª­ã¿æ›¸ãå¯èƒ½ãªãƒ‡ãƒ¼ã‚¿é ˜åŸŸï¼åˆæœŸåŒ–ã•ã‚Œãªã„ï¼</p>
</li>
<li>
<p>.bssï¼šèª­ã¿æ›¸ãå¯èƒ½ãªãƒ‡ãƒ¼ã‚¿é ˜åŸŸï¼åˆæœŸåŒ–ã•ã‚Œã‚‹ï¼16ãƒã‚¤ãƒˆã‚¢ãƒ©ã‚¤ãƒ³ã•ã‚Œã¦ã„ã‚‹ï¼</p>
</li>
<li>
<p>.gotï¼šä½•ã«ä½¿ã†ã®ã‹åˆ†ã‹ã‚‰ãªã„</p>
</li>
</ul>
<h2 id="bootrs">boot.rs<a href="#bootrs" class="anchor" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"
      stroke-linecap="round" stroke-linejoin="round">
      <path d="M15 7h3a5 5 0 0 1 5 5 5 5 0 0 1-5 5h-3m-6 0H6a5 5 0 0 1-5-5 5 5 0 0 1 5-5h3"></path>
      <line x1="8" y1="12" x2="16" y2="12"></line>
   </svg></a></h2>
<ul>
<li><code>MPIDR_EL1</code>ï¼š<code>PE (Processor Element)</code> ã‚’è­˜åˆ¥ã™ã‚‹ãŸã‚ã®ãƒ¬ã‚¸ã‚¹ã‚¿</li>
<li><code>CONST_CORE_ID_MASK</code> ã¯ <code>src/_arch/aarch64/cpu/boot.rs</code> ã§å®šç¾©ã•ã‚Œã¦ã„ã‚‹å®šæ•°ã‹
<ul>
<li>0b11 ãªã®ã§ 3ç•ªç›®ã® PE ãŒ boot core ã¨ã—ã¦åˆæœŸåŒ–å‡¦ç†ã‚’è¡Œã†</li>
<li>ä»–ã® PE ã¯ <code>L_parking_loop</code> ã§ç„¡é™ãƒ«ãƒ¼ãƒ—ï¼ˆ=ä½•ã‚‚ã•ã›ãªã„ï¼‰</li>
</ul>
</li>
<li>x0, x1 ãƒ¬ã‚¸ã‚¹ã‚¿ã«ãã‚Œãã‚Œ <code>__bss_start</code>, <code>__bss_end_exclusive</code> ã‚’ã‚»ãƒƒãƒˆ</li>
<li>.bss ã‚’ã‚¼ãƒ­åŸ‹ã‚
<ul>
<li>ã‚¢ã‚»ãƒ³ãƒ–ãƒªå‘½ä»¤ï¼š<code>stp	xzr, xzr, [x0], #16</code>
<ul>
<li>stp: ãƒ¬ã‚¸ã‚¹ã‚¿ãƒšã‚¢ã®å†…å®¹ã‚’ä¸»è¨˜æ†¶ã«æ›¸ãè¾¼ã¿</li>
<li>xzr: ã‚¼ãƒ­ãƒ¬ã‚¸ã‚¹ã‚¿</li>
<li>[x0]: æ›¸ãè¾¼ã¿å…ˆã®ãƒã‚¤ãƒ³ã‚¿</li>
<li>#16: æ›¸ãè¾¼ã¿å…ˆã‚¢ãƒ‰ãƒ¬ã‚¹ã¸ã®ã‚ªãƒ•ã‚»ãƒƒãƒˆ
<ul>
<li>stp å‘½ä»¤ã«ã‚ˆã‚‹æ›¸ãè¾¼ã¿å¾Œï¼Œx0 += 16 ã•ã‚Œã‚‹</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li><code>.L_prepare_rust</code> ä»¥é™
<ul>
<li>ã‚¹ã‚¿ãƒƒã‚¯ãƒã‚¤ãƒ³ã‚¿ã‚’æ©Ÿæ¢°èªå‘½ä»¤åˆ—ã®å…ˆé ­ã¸ã‚»ãƒƒãƒˆ</li>
<li><code>_start_rust</code> ã¸åˆ†å²</li>
</ul>
</li>
</ul>
<h1 id="å®Ÿè¡Œçµæœ">å®Ÿè¡Œçµæœ<a href="#%e5%ae%9f%e8%a1%8c%e7%b5%90%e6%9e%9c" class="anchor" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"
      stroke-linecap="round" stroke-linejoin="round">
      <path d="M15 7h3a5 5 0 0 1 5 5 5 5 0 0 1-5 5h-3m-6 0H6a5 5 0 0 1-5-5 5 5 0 0 1 5-5h3"></path>
      <line x1="8" y1="12" x2="16" y2="12"></line>
   </svg></a></h1>
<pre tabindex="0"><code>$ make

Compiling kernel ELF - rpi3
   Compiling tock-registers v0.8.1
   Compiling mingo v0.2.0 (/home/kenta/Git/Kenta11/rust-raspberrypi-OS-tutorials/02_runtime_init)
   Compiling aarch64-cpu v9.0.0
    Finished release [optimized] target(s) in 5.86s

Generating stripped binary
        Name kernel8.img
        Size 1 KiB
$ sudo make qemu

Launching QEMU
----------------
IN: 
0x00000300:  d2801b05  mov      x5, #0xd8
0x00000304:  d53800a6  mrs      x6, mpidr_el1
0x00000308:  924004c6  and      x6, x6, #3
0x0000030c:  d503205f  wfe      
0x00000310:  f86678a4  ldr      x4, [x5, x6, lsl #3]
0x00000314:  b4ffffc4  cbz      x4, #0x30c

----------------
IN: 
0x00000300:  d2801b05  mov      x5, #0xd8
0x00000304:  d53800a6  mrs      x6, mpidr_el1
0x00000308:  924004c6  and      x6, x6, #3
0x0000030c:  d503205f  wfe      
0x00000310:  f86678a4  ldr      x4, [x5, x6, lsl #3]
0x00000314:  b4ffffc4  cbz      x4, #0x30c

----------------
IN: 
0x00000000:  580000c0  ldr      x0, #0x18
0x00000004:  aa1f03e1  mov      x1, xzr
0x00000008:  aa1f03e2  mov      x2, xzr
0x0000000c:  aa1f03e3  mov      x3, xzr
0x00000010:  58000084  ldr      x4, #0x20
0x00000014:  d61f0080  br       x4

----------------
IN: 
0x00000300:  d2801b05  mov      x5, #0xd8
0x00000304:  d53800a6  mrs      x6, mpidr_el1
0x00000308:  924004c6  and      x6, x6, #3
0x0000030c:  d503205f  wfe      
0x00000310:  f86678a4  ldr      x4, [x5, x6, lsl #3]
0x00000314:  b4ffffc4  cbz      x4, #0x30c

----------------
IN: 
0x0000030c:  d503205f  wfe      
0x00000310:  f86678a4  ldr      x4, [x5, x6, lsl #3]
0x00000314:  b4ffffc4  cbz      x4, #0x30c

----------------
IN: 
0x0000030c:  d503205f  wfe      
0x00000310:  f86678a4  ldr      x4, [x5, x6, lsl #3]
0x00000314:  b4ffffc4  cbz      x4, #0x30c

----------------
IN: 
0x00080000:  d53800a0  mrs      x0, mpidr_el1
0x00080004:  92400400  and      x0, x0, #3
0x00080008:  58000241  ldr      x1, #0x80050
0x0008000c:  eb01001f  cmp      x0, x1
0x00080010:  540001a1  b.ne     #0x80044

----------------
IN: 
0x0000030c:  d503205f  wfe      
0x00000310:  f86678a4  ldr      x4, [x5, x6, lsl #3]
0x00000314:  b4ffffc4  cbz      x4, #0x30c

----------------
IN: 
0x00080014:  d503201f  nop      
0x00080018:  10000440  adr      x0, #0x800a0
0x0008001c:  d503201f  nop      
0x00080020:  10000401  adr      x1, #0x800a0
0x00080024:  eb01001f  cmp      x0, x1
0x00080028:  54000060  b.eq     #0x80034

----------------
IN: 
0x00080034:  d503201f  nop      
0x00080038:  10fffe40  adr      x0, #0x80000
0x0008003c:  9100001f  mov      sp, x0
0x00080040:  14000008  b        #0x80060

----------------
IN: 
0x00080060:  94000004  bl       #0x80070

----------------
IN: 
0x00080070:  94000004  bl       #0x80080

----------------
IN: 
0x00080080:  97fffffe  bl       #0x80078

----------------
IN: 
0x00080078:  94000006  bl       #0x80090

----------------
IN: 
0x00080090:  d503205f  wfe      
0x00080094:  17ffffff  b        #0x80090
</code></pre><h1 id="æ„Ÿæƒ³">æ„Ÿæƒ³<a href="#%e6%84%9f%e6%83%b3" class="anchor" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"
      stroke-linecap="round" stroke-linejoin="round">
      <path d="M15 7h3a5 5 0 0 1 5 5 5 5 0 0 1-5 5h-3m-6 0H6a5 5 0 0 1-5-5 5 5 0 0 1 5-5h3"></path>
      <line x1="8" y1="12" x2="16" y2="12"></line>
   </svg></a></h1>
<ul>
<li>Rust ã‚³ãƒ¼ãƒ‰ã‚’å®Ÿè¡Œã§ãã‚‹ã‚ˆã†ã«ãªã£ãŸã®ã§ï¼Œã„ã‚ˆã„ã‚ˆ Rust ã§æ›¸ã„ãŸ OS ã®æ©Ÿèƒ½ã§éŠã¹ãã†ã </li>
<li>stp ãŒä¸€å‘½ä»¤ã§è‰²ã€…ã§ãã‚‹ã“ã¨ã«ãƒ“ãƒƒã‚¯ãƒªã—ãŸ
<ul>
<li>MIPS ã‚„ RISC-V ã®æ–¹ãŒæ…£ã‚Œã¦ã„ã‚‹ã®ã§ï¼ŒARM ãŒ CISC ãƒ—ãƒ­ã‚»ãƒƒã‚µã®ã‚ˆã†ã«æ€ãˆã¦ã—ã¾ã†</li>
</ul>
</li>
</ul>
]]></content></item><item><title>Operating System development tutorials in Rust on the Raspberry Pi ã‚’ã™ã‚‹ #1</title><link>https://Kenta11.github.io/posts/2023-01-30-rust-raspberrypi-os-tutorials/</link><pubDate>Mon, 30 Jan 2023 22:30:15 +0900</pubDate><guid>https://Kenta11.github.io/posts/2023-01-30-rust-raspberrypi-os-tutorials/</guid><description>&amp;lt;no value&amp;gt;</description><content type="text/html" mode="escaped"><![CDATA[<h1 id="ã¯ã˜ã‚ã«">ã¯ã˜ã‚ã«<a href="#%e3%81%af%e3%81%98%e3%82%81%e3%81%ab" class="anchor" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"
      stroke-linecap="round" stroke-linejoin="round">
      <path d="M15 7h3a5 5 0 0 1 5 5 5 5 0 0 1-5 5h-3m-6 0H6a5 5 0 0 1-5-5 5 5 0 0 1 5-5h3"></path>
      <line x1="8" y1="12" x2="16" y2="12"></line>
   </svg></a></h1>
<p>Rust ã§ Raspberry Pi å‘ã‘ã®ã‚ªãƒšãƒ¬ãƒ¼ãƒ†ã‚£ãƒ³ã‚°ã‚·ã‚¹ãƒ†ãƒ ã‚’é–‹ç™ºã™ã‚‹<a href="https://github.com/rust-embedded/rust-raspberrypi-OS-tutorials">ãƒãƒ¥ãƒ¼ãƒˆãƒªã‚¢ãƒ«</a>ãŒå…¬é–‹ã•ã‚Œã¦ã„ã‚‹ï¼
æ—©é€Ÿã‚„ã£ã¦ã¿ã‚ˆã†ï¼</p>
<h1 id="00_before_we_starthttpsgithubcomrust-embeddedrust-raspberrypi-os-tutorialstreemaster00_before_we_start"><a href="https://github.com/rust-embedded/rust-raspberrypi-OS-tutorials/tree/master/00_before_we_start">00_before_we_start</a><a href="#00_before_we_starthttpsgithubcomrust-embeddedrust-raspberrypi-os-tutorialstreemaster00_before_we_start" class="anchor" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"
      stroke-linecap="round" stroke-linejoin="round">
      <path d="M15 7h3a5 5 0 0 1 5 5 5 5 0 0 1-5 5h-3m-6 0H6a5 5 0 0 1-5-5 5 5 0 0 1 5-5h3"></path>
      <line x1="8" y1="12" x2="16" y2="12"></line>
   </svg></a></h1>
<ul>
<li>ãƒ—ãƒ­ã‚»ãƒƒã‚µãƒ»ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£å›ºæœ‰ã®ã‚½ãƒ¼ã‚¹ã‚³ãƒ¼ãƒ‰ã¯ <code>src/_arch</code> ã«é…ç½®ã•ã‚Œã‚‹
<ul>
<li>ä¾‹ï¼š<code>aarch64</code> å‘ã‘ã®ã‚³ãƒ¼ãƒ‰ã¯ <code>src/_arch/aarch64</code> ã«ç½®ã‹ã‚Œã‚‹</li>
</ul>
</li>
<li>ãƒœãƒ¼ãƒ‰å›ºæœ‰ã®ã‚½ãƒ¼ã‚¹ã‚³ãƒ¼ãƒ‰ã¯ <code>src/bsp.rs</code> ã«æ›¸ã‹ã‚Œã‚‹</li>
<li>ã€Œã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£ã¨ãƒœãƒ¼ãƒ‰ã€ã¨ã‚«ãƒ¼ãƒãƒ«ã¯ï¼Œãƒˆãƒ¬ã‚¤ãƒˆã§æŠ½è±¡åŒ–ã•ã‚ŒãŸã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹ã§åˆ†é›¢ã•ã‚Œã‚‹
<ul>
<li>ã‚¯ãƒªãƒ¼ãƒ³ãªæŠ½è±¡ã‚’æä¾›ã™ã‚‹</li>
</ul>
</li>
<li>boot ã®æµã‚Œ
<ul>
<li>ã‚¨ãƒ³ãƒˆãƒªãƒã‚¤ãƒ³ãƒˆã¯ <code>cpu::boot::arch_boot::_start()</code> (<code>src/_arch/__arch_name__/cpu/boot.s</code>)</li>
</ul>
</li>
</ul>
<h1 id="01_wait_foreverhttpsgithubcomrust-embeddedrust-raspberrypi-os-tutorialstreemaster01_wait_forever"><a href="https://github.com/rust-embedded/rust-raspberrypi-OS-tutorials/tree/master/01_wait_forever">01_wait_forever</a><a href="#01_wait_foreverhttpsgithubcomrust-embeddedrust-raspberrypi-os-tutorialstreemaster01_wait_forever" class="anchor" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"
      stroke-linecap="round" stroke-linejoin="round">
      <path d="M15 7h3a5 5 0 0 1 5 5 5 5 0 0 1-5 5h-3m-6 0H6a5 5 0 0 1-5-5 5 5 0 0 1 5-5h3"></path>
      <line x1="8" y1="12" x2="16" y2="12"></line>
   </svg></a></h1>
<ul>
<li>ã™ã¹ã¦ã® CPU ã‚³ã‚¢ã‚’ halt ã•ã›ã‚‹ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆ
<ul>
<li>Rust ã‚³ãƒ¼ãƒ‰ã«ã¯ã»ã¨ã‚“ã©å‡¦ç†ãŒè¨˜è¿°ã•ã‚Œã¦ã„ãªã„
<ul>
<li>ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã®å®šç¾©ã‚„ã‚¢ã‚»ãƒ³ãƒ–ãƒªã‚³ãƒ¼ãƒ‰ (<code>src/_arch/aarch64/cpu/boot.rs</code>)ï¼Œãƒ‘ãƒ‹ãƒƒã‚¯ã®å®šç¾© (<code>src/cpu/panic_wait.rs</code>) ãªã©</li>
</ul>
</li>
<li>OS ã¯ qemu ã§å®Ÿè¡Œã§ãã‚‹ã‚ˆã†ã </li>
</ul>
</li>
<li>qemu ã§ OS ã‚’å‹•ã‹ã—ã¦ã¿ã‚ˆã†</li>
</ul>
<pre tabindex="0"><code>$ make qemu

Compiling kernel ELF - rpi3
   Compiling mingo v0.1.0 (/home/kenta/Git/Kenta11/rust-raspberrypi-OS-tutorials/01_wait_forever)
    Finished release [optimized] target(s) in 0.32s

Generating stripped binary
make: rust-objcopy: ãã®ã‚ˆã†ãªãƒ•ã‚¡ã‚¤ãƒ«ã‚„ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã¯ã‚ã‚Šã¾ã›ã‚“
make: *** [Makefile:130: kernel8.img] ã‚¨ãƒ©ãƒ¼ 127
</code></pre><ul>
<li><code>rust-objcopy</code> ãŒç„¡ã„ã¨è¨€ã‚ã‚ŒãŸ</li>
<li><code>rust-objcopy</code> ã¯ <a href="https://github.com/rust-embedded/cargo-binutils">cargo-binutils</a> ã«å«ã¾ã‚Œã‚‹ã‚³ãƒãƒ³ãƒ‰ã®ã‚ˆã†ã 
<ul>
<li>LLVM ã®ãƒ„ãƒ¼ãƒ«ãƒã‚§ã‚¤ãƒ³ã‚’å‘¼ã³å‡ºã™ã‚³ãƒãƒ³ãƒ‰ã£ã½ã„ï¼Ÿ</li>
</ul>
</li>
<li>ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã—ã¦å†åº¦ OS ã‚’å‹•ã‹ãã†</li>
</ul>
<pre tabindex="0"><code>$ cargo install cargo-binutils
ï¼ˆã¨ã¦ã‚‚æ™‚é–“ãŒã‹ã‹ã‚‹ï¼‰
$ make qemu

Generating stripped binary
        Name kernel8.img
        Size 1 KiB

Launching QEMU
docker: Cannot connect to the Docker daemon at unix:///var/run/docker.sock. Is the docker daemon running?.
See &#39;docker run --help&#39;.
make: *** [Makefile:155: qemu] ã‚¨ãƒ©ãƒ¼ 125
</code></pre><ul>
<li>docker ã‚‚å‹•ã‹ã•ãªã„ã¨ã„ã‘ãªã„ã‚‰ã—ã„</li>
</ul>
<pre tabindex="0"><code>$ sudo systemctl restart docker
$ make qemu

Launching QEMU
docker: Got permission denied while trying to connect to the Docker daemon socket at unix:///var/run/docker.sock: Post &#34;http://%2Fvar%2Frun%2Fdocker.sock/v1.24/containers/create&#34;: dial unix /var/run/docker.sock: connect: permission denied.
See &#39;docker run --help&#39;.
make: *** [Makefile:155: qemu] ã‚¨ãƒ©ãƒ¼ 126
</code></pre><ul>
<li>ç®¡ç†è€…æ¨©é™ã¾ã§å¿…è¦ãªã®ã‹&hellip;ï¼ˆdocker ã‚’ä½¿ã†ä»¥ä¸Šå½“ãŸã‚Šå‰ã ãŒï¼‰</li>
</ul>
<pre tabindex="0"><code>$ sudo make qemu

Launching QEMU
Unable to find image &#39;rustembedded/osdev-utils:2021.12&#39; locally
2021.12: Pulling from rustembedded/osdev-utils
7b1a6ab2e44d: Pull complete 
292c6ce995b4: Pull complete 
afb6c3c2887b: Pull complete 
888e016a338b: Pull complete 
59ca2d6f9c6f: Pull complete 
1ac893ad5b73: Pull complete 
008bb9e6650e: Pull complete 
Digest: sha256:9883c96e0e827e35b8d716683f85c7a9b8ffed85422fe418ed080d61e8641e78
Status: Downloaded newer image for rustembedded/osdev-utils:2021.12
----------------
IN: 
0x00000000:  580000c0  ldr      x0, #0x18
0x00000004:  aa1f03e1  mov      x1, xzr
0x00000008:  aa1f03e2  mov      x2, xzr
0x0000000c:  aa1f03e3  mov      x3, xzr
0x00000010:  58000084  ldr      x4, #0x20
0x00000014:  d61f0080  br       x4

----------------
IN: 
0x00000300:  d2801b05  mov      x5, #0xd8
0x00000304:  d53800a6  mrs      x6, mpidr_el1
0x00000308:  924004c6  and      x6, x6, #3
0x0000030c:  d503205f  wfe      
0x00000310:  f86678a4  ldr      x4, [x5, x6, lsl #3]
0x00000314:  b4ffffc4  cbz      x4, #0x30c

----------------
IN: 
0x00000300:  d2801b05  mov      x5, #0xd8
0x00000304:  d53800a6  mrs      x6, mpidr_el1
0x00000308:  924004c6  and      x6, x6, #3
0x0000030c:  d503205f  wfe      
0x00000310:  f86678a4  ldr      x4, [x5, x6, lsl #3]
0x00000314:  b4ffffc4  cbz      x4, #0x30c

----------------
IN: 
0x00000300:  d2801b05  mov      x5, #0xd8
0x00000304:  d53800a6  mrs      x6, mpidr_el1
0x00000308:  924004c6  and      x6, x6, #3
0x0000030c:  d503205f  wfe      
0x00000310:  f86678a4  ldr      x4, [x5, x6, lsl #3]
0x00000314:  b4ffffc4  cbz      x4, #0x30c

----------------
IN: 
0x00080000:  d503205f  wfe      
0x00080004:  17ffffff  b        #0x80000

----------------
IN: 
0x0000030c:  d503205f  wfe      
0x00000310:  f86678a4  ldr      x4, [x5, x6, lsl #3]
0x00000314:  b4ffffc4  cbz      x4, #0x30c

----------------
IN: 
0x0000030c:  d503205f  wfe      
0x00000310:  f86678a4  ldr      x4, [x5, x6, lsl #3]
0x00000314:  b4ffffc4  cbz      x4, #0x30c

----------------
IN: 
0x0000030c:  d503205f  wfe      
0x00000310:  f86678a4  ldr      x4, [x5, x6, lsl #3]
0x00000314:  b4ffffc4  cbz      x4, #0x30c
</code></pre><ul>
<li>
<p>0x80000 ç•ªåœ°ã§ç„¡é™ãƒ«ãƒ¼ãƒ—ã‚’ã—ã¦ã„ã‚‹ã“ã¨ãŒåˆ†ã‹ã‚‹</p>
</li>
<li>
<p>ãã‚Œä»¥å¤–ã®å‘½ä»¤ã§ä½•ã‚’ã—ã¦ã„ã‚‹ã®ã‹ãŒåˆ†ã‹ã‚‰ãªã„</p>
<ul>
<li>Raspberry Pi 3B+ ã«æ­è¼‰ã•ã‚ŒãŸ SoC ã¯4ã‚³ã‚¢æ§‹æˆãªã®ã§ï¼Œä½¿ã‚ãªã„ã‚³ã‚¢ã‚‚ï¼ˆ0x30C-0x314 ç•ªåœ°ã§ï¼‰ç„¡é™ãƒ«ãƒ¼ãƒ—ã—ã¦ã„ã‚‹ï¼Ÿ</li>
</ul>
</li>
<li>
<p>åˆ†ã‹ã‚‰ãªã„ã¨ã“ã‚ãŒã‹ãªã‚Šã‚ã‚‹ãŒï¼Œé€²ã‚ã¦ã„ãã†ã¡ã«åˆ†ã‹ã‚‹ã‹ã‚‚ã—ã‚Œãªã„</p>
</li>
<li>
<p>ã¨ã‚Šã‚ãˆãšæ¬¡ã«é€²ã‚‚ã†</p>
</li>
</ul>
]]></content></item><item><title>Electron-Shogi &amp; æ°´åŒ 5 on Manjaro</title><link>https://Kenta11.github.io/posts/2023-01-01-shogi-on-manjaro/</link><pubDate>Sun, 01 Jan 2023 00:00:00 +0900</pubDate><guid>https://Kenta11.github.io/posts/2023-01-01-shogi-on-manjaro/</guid><description>&amp;lt;no value&amp;gt;</description><content type="text/html" mode="escaped"><![CDATA[<h2 id="ã¯ã˜ã‚ã«">ã¯ã˜ã‚ã«<a href="#%e3%81%af%e3%81%98%e3%82%81%e3%81%ab" class="anchor" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"
      stroke-linecap="round" stroke-linejoin="round">
      <path d="M15 7h3a5 5 0 0 1 5 5 5 5 0 0 1-5 5h-3m-6 0H6a5 5 0 0 1-5-5 5 5 0 0 1 5-5h3"></path>
      <line x1="8" y1="12" x2="16" y2="12"></line>
   </svg></a></h2>
<p>ã†ã¡ã«ã¯å¼·ã„ãƒã‚·ãƒ³ãŒ Manjaro ã‚µãƒ¼ãƒã—ã‹ãªã„ã®ã§ï¼Œå°†æ£‹ã®è§£æã‚’ã“ã®ã‚µãƒ¼ãƒã§ã‚„ã‚ŠãŸã„ï¼
ãŸã ã—ï¼Œã„ã‚ã‚†ã‚‹å°†æ£‹ã‚½ãƒ•ãƒˆã¯ Windows ã§ä½¿ã†ã“ã¨ã‚’å‰æã¨ã—ã¦ã„ã‚‹ã®ã§ï¼ŒManjaro ãªã‚“ã¦ã„ã†å¤‰ãªç’°å¢ƒã§ãƒˆãƒ©ã‚¤ã—ãŸäººã¯ã„ãªã•ãã†ã ï¼
çªè²«å·¥äº‹ã§ã¯ã‚ã‚‹ãŒï¼ŒManjaro ã®ãƒ‡ã‚¹ã‚¯ãƒˆãƒƒãƒ—ç’°å¢ƒã§å°†æ£‹ã®è§£æãŒã§ãã‚‹ç’°å¢ƒã‚’ä½œã£ãŸã®ã§ï¼Œãã®æ‰‹é †ã‚’è¨˜éŒ²ã—ã¦ãŠãï¼</p>
<p>å¹´ã®ç€¬ã«ãªã«ã‚„ã£ã¦ã‚“ã ï¼</p>
<p><img src="shogi-on-manjaro.png" alt="Electron å°†æ£‹" title="Electron å°†æ£‹ ã¨ æ°´åŒ 5 ã§è§£æã—ã¦ã„ã‚‹æ§˜å­"></p>
<h2 id="1-uielectron-å°†æ£‹ã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«">1. UIï¼ˆElectron å°†æ£‹ï¼‰ã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«<a href="#1-uielectron-%e5%b0%86%e6%a3%8b%e3%82%92%e3%82%a4%e3%83%b3%e3%82%b9%e3%83%88%e3%83%bc%e3%83%ab" class="anchor" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"
      stroke-linecap="round" stroke-linejoin="round">
      <path d="M15 7h3a5 5 0 0 1 5 5 5 5 0 0 1-5 5h-3m-6 0H6a5 5 0 0 1-5-5 5 5 0 0 1 5-5h3"></path>
      <line x1="8" y1="12" x2="16" y2="12"></line>
   </svg></a></h2>
<p>ã¾ãš Electron å°†æ£‹ ã®å…¬å¼ãƒªãƒã‚¸ãƒˆãƒªã‹ã‚‰ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆä¸€å¼ã‚’ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã™ã‚‹ï¼npm ã§ãƒ“ãƒ«ãƒ‰ã—ï¼Œç”Ÿæˆã•ã‚ŒãŸå®Ÿè¡Œãƒã‚¤ãƒŠãƒªã‚’ <code>~/.local/bin/</code> ã«é…ç½®ã™ã‚‹ï¼npm ç³»ã®ã‚³ãƒãƒ³ãƒ‰ã¯æ—¢ã«ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã—ã¦ã„ãŸã®ã§ï¼Œç’°å¢ƒã«ã‚ˆã£ã¦ã¯æº–å‚™ãŒå¿…è¦ã‹ã‚‚ã—ã‚Œãªã„ï¼</p>
<pre tabindex="0"><code>$ gh repo clone https://github.com/sunfish-shogi/electron-shogi
$ cd electron-shogi
$ git checkout v1.3.0 # å®‰å®šç‰ˆãŒ v1.3.0 ã‚‰ã—ã„
$ npm install @vue/cli @vue/cli-service-global
$ npm run electron:build
$ find . -name &#39;ElectronShogi*&#39;
./dist_electron/ElectronShogi-1.3.0.AppImage
$ cp $(find . -name &#39;ElectronShogi*&#39;) ~/.local/bin/
</code></pre><h2 id="2-ã‚¨ãƒ³ã‚¸ãƒ³yaneuraouã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«">2. ã‚¨ãƒ³ã‚¸ãƒ³ï¼ˆYaneuraOuï¼‰ã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«<a href="#2-%e3%82%a8%e3%83%b3%e3%82%b8%e3%83%b3yaneuraou%e3%82%92%e3%82%a4%e3%83%b3%e3%82%b9%e3%83%88%e3%83%bc%e3%83%ab" class="anchor" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"
      stroke-linecap="round" stroke-linejoin="round">
      <path d="M15 7h3a5 5 0 0 1 5 5 5 5 0 0 1-5 5h-3m-6 0H6a5 5 0 0 1-5-5 5 5 0 0 1 5-5h3"></path>
      <line x1="8" y1="12" x2="16" y2="12"></line>
   </svg></a></h2>
<p>ã“ã¡ã‚‰ã‚‚ã¾ãšã¯ YaneuraOu ã®å…¬å¼ãƒªãƒã‚¸ãƒˆãƒªã‹ã‚‰ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆä¸€å¼ã‚’ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã™ã‚‹ï¼Makefile ã®è¨­å®šã‚’ç’°å¢ƒã«åˆã‚ã›ã¦ç·¨é›†ã—ï¼Œã‚³ãƒ³ãƒ‘ã‚¤ãƒ«ã‚’å®Ÿæ–½ã™ã‚‹ï¼
Manjaro ã‚µãƒ¼ãƒã® CPU ã¯ Ryzen 7 3700X ãªã®ã§ï¼ŒTARGET_CPU ã¯ ZEN2 ã¨ã—ãŸï¼</p>
<pre tabindex="0"><code>$ gh repo clone https://github.com/Kenta11/YaneuraOu
$ cd YaneuraOu/source
$ vim Makefile # ä»Šå›ã¯ TARGET_CPU ã‚’ AVX2 ã‹ã‚‰ ZEN2 ã«å¤‰æ›´
$ make # ä¸¦åˆ—ã‚ªãƒ—ã‚·ãƒ§ãƒ³ -j ã‚’ä½¿ã†ã¨ã‚³ã‚±ãŸã
$ find . -name YaneuraOu-by-gcc
./YaneuraOu-by-gcc
</code></pre><h2 id="3-è©•ä¾¡é–¢æ•°æ°´åŒ 5ã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«">3. è©•ä¾¡é–¢æ•°ï¼ˆæ°´åŒ 5ï¼‰ã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«<a href="#3-%e8%a9%95%e4%be%a1%e9%96%a2%e6%95%b0%e6%b0%b4%e5%8c%a05%e3%82%92%e3%82%a4%e3%83%b3%e3%82%b9%e3%83%88%e3%83%bc%e3%83%ab" class="anchor" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"
      stroke-linecap="round" stroke-linejoin="round">
      <path d="M15 7h3a5 5 0 0 1 5 5 5 5 0 0 1-5 5h-3m-6 0H6a5 5 0 0 1-5-5 5 5 0 0 1 5-5h3"></path>
      <line x1="8" y1="12" x2="16" y2="12"></line>
   </svg></a></h2>
<p>æ°´åŒ 5 ã®è©•ä¾¡é–¢æ•°ã‚’ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã™ã‚‹ï¼YaneuraOu ã®å®Ÿè¡Œãƒã‚¤ãƒŠãƒªãŒã‚ã‚‹ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªä¸‹ã® <code>eval</code> ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã« <code>nn.bin</code> ã‚’é…ç½®ã™ã‚‹ï¼</p>
<pre tabindex="0"><code>$ gh repo clone https://github.com/HiraokaTakuya/get_suisho5_nn
$ cp get_suisho5_nn/nn.bin /path/to/YaneuraOu/source/eval/
</code></pre><h2 id="4-ui-ã‹ã‚‰ã‚¨ãƒ³ã‚¸ãƒ³ã‚’é¸æŠ">4. UI ã‹ã‚‰ã‚¨ãƒ³ã‚¸ãƒ³ã‚’é¸æŠ<a href="#4-ui-%e3%81%8b%e3%82%89%e3%82%a8%e3%83%b3%e3%82%b8%e3%83%b3%e3%82%92%e9%81%b8%e6%8a%9e" class="anchor" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"
      stroke-linecap="round" stroke-linejoin="round">
      <path d="M15 7h3a5 5 0 0 1 5 5 5 5 0 0 1-5 5h-3m-6 0H6a5 5 0 0 1-5-5 5 5 0 0 1 5-5h3"></path>
      <line x1="8" y1="12" x2="16" y2="12"></line>
   </svg></a></h2>
<ul>
<li><code>electron-shogi</code> ã‚’å®Ÿè¡Œ</li>
<li>&ldquo;è¨­å®š&rdquo;&gt;&ldquo;ã‚¨ãƒ³ã‚¸ãƒ³è¨­å®š&rdquo; ã‚’é¸æŠã—ï¼Œã‚¨ãƒ³ã‚¸ãƒ³ï¼ˆYaneuraOuï¼‰ã‚’é¸æŠ</li>
<li>&ldquo;æ¤œè¨&rdquo;&gt;&ldquo;æ¤œè¨é–‹å§‹&rdquo; ã§å±€é¢ã‚’è§£æã§ãã‚‹</li>
</ul>
<h2 id="ãŠã‚ã‚Šã«">ãŠã‚ã‚Šã«<a href="#%e3%81%8a%e3%82%8f%e3%82%8a%e3%81%ab" class="anchor" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"
      stroke-linecap="round" stroke-linejoin="round">
      <path d="M15 7h3a5 5 0 0 1 5 5 5 5 0 0 1-5 5h-3m-6 0H6a5 5 0 0 1-5-5 5 5 0 0 1 5-5h3"></path>
      <line x1="8" y1="12" x2="16" y2="12"></line>
   </svg></a></h2>
<p>å°†æ£‹ã®å±€é¢ã®è§£æãŒè‡ªå®…ãƒã‚·ãƒ³ã§ã§ãã‚‹ã‚ˆã†ã«ãªã£ãŸï¼
ä»¥ä¸Šã®æ–¹æ³•ã§æ§‹ç¯‰ã—ãŸç’°å¢ƒãŒãƒ™ã‚¹ãƒˆãªã®ã‹ã¯åˆ†ã‹ã‚‰ãªã„ãŒï¼Œå°‘ãªãã¨ã‚‚ãƒ—ãƒ­æ£‹å£«ãŒä½¿ã†ã‚ˆã†ãªè§£æç’°å¢ƒã¯å¿…è¦ãªã„ã®ã§ï¼Œã“ã‚Œã§æº€è¶³ã ï¼</p>
]]></content></item><item><title>ã“ã‚Œã¾ã§ã«è¦³ãŸå¤å…¸èŠ¸èƒ½ã®æ¼”ç›®</title><link>https://Kenta11.github.io/posts/2022-12-19-classic-engei/</link><pubDate>Mon, 19 Dec 2022 22:00:00 +0900</pubDate><guid>https://Kenta11.github.io/posts/2022-12-19-classic-engei/</guid><description>&amp;lt;no value&amp;gt;</description><content type="text/html" mode="escaped"><![CDATA[<p>ã“ã‚Œã¾ã§ã«ä½•åº¦ã‹å¤å…¸èŠ¸èƒ½ã‚’è¦³ã‚‹æ©Ÿä¼šãŒã‚ã£ã¦ï¼Œé¢ç™½ã„ãªã¨æ€ã†ã“ã¨ãŒå¢—ãˆã¦ããŸï¼
ãã“ã§ï¼Œã“ã‚Œã¾ã§ã«è¦³ãŸæ¼”ç›®ã‚’è¨˜éŒ²ã—ã¦ãŠãï¼
å®Ÿéš›ã«åŠ‡å ´ç­‰ã§è¦³ãŸã‚‚ã®ã¯å°‘ãªã„ã®ã§ï¼Œãƒ†ãƒ¬ãƒ“ ã‚„ YouTube ã§è¦³ãŸã‚‚ã®ã‚‚å«ã‚ã¦è¨˜è¼‰ã™ã‚‹ï¼</p>
<ul>
<li>è½èª
<ul>
<li>ä¸€æ–‡ç¬›</li>
<li>è¦èŸ‡ã®æ²¹</li>
<li>ç´™å…¥ã‚Œ</li>
<li>ç´ºå±‹é«˜å°¾</li>
<li>é»„é‡‘é¤…</li>
<li>ä¸‰æ–¹ä¸€ä¸¡æ</li>
<li>æ­»ç¥</li>
<li>èŠæµœ</li>
<li>å¯¿é™ç„¡</li>
<li>ç²—å¿½é•·å±‹</li>
<li>å¤§å·¥èª¿ã¹</li>
<li>å¹‡é–“è…¹</li>
<li>çŸ­å‘½</li>
<li>æ™‚ãã°</li>
<li>çŒ«ã®çš¿</li>
<li>é¼ ç©´</li>
<li>å¼•è¶Šã—ã®å¤¢</li>
<li>èˆ¹å¾³</li>
<li>é¥…é ­ã“ã‚ã„</li>
<li>ã‚‰ãã </li>
</ul>
</li>
<li>è¬›è«‡
<ul>
<li>é€£ç¶šç‰©
<ul>
<li>èµ¤å£æºè”µ å¾³åˆ©ã®åˆ¥ã‚Œ</li>
<li>èµ¤ç©‚ç¾©å£«éŠ˜ã€…ä¼ å¤§é«˜æºå¾</li>
<li>ç•”å€‰é‡å››éƒ</li>
<li>å¯›æ°¸å®®æœ¬æ­¦è”µä¼ å‰å²¡æ²»å¤ªå¤«</li>
<li>ç¬¹é‡åæ§ä¼ æµ·è³Šé€€æ²»</li>
<li>å¤©ä¿å…­èŠ±æ’° ç‰å­ã®å¼·è«‹</li>
<li>æºå¹³ç››è¡°è¨˜ æ‰‡ã®çš„</li>
</ul>
</li>
<li>ç«¯ç‰©
<ul>
<li>é®«è¬›é‡ˆ</li>
<li>é¹¿æ”¿è«‡</li>
<li>é’é¾åˆ€æ¨©æ¬¡</li>
<li>æ±ç‰ã¨ä¼¯åœ“</li>
<li>ä¸­æ‘ä»²è”µ</li>
</ul>
</li>
</ul>
</li>
</ul>
<p>ã“ã‚Œã¾ã§ãŸãã•ã‚“è´ã„ãŸãªã‚ã¨æ€ã£ã¦ã„ãŸã‘ã‚Œã©ï¼Œé¡Œç›®ã‚’èµ·ã“ã—ã¦ã¿ã‚‹ã¨æ€ã„ã®å¤–å°‘ãªã„ï¼
æ¥å¹´ã¯å°‘ã—ãšã¤å¢—ã‚„ã—ã¦ã„ã“ã†ï¼</p>
]]></content></item><item><title>æƒ…å ±å·¥å­¦å®Ÿé¨“IIï¼ˆå†å±¥ä¿®ï¼‰</title><link>https://Kenta11.github.io/posts/2022-09-23-micro1/</link><pubDate>Fri, 23 Sep 2022 22:00:00 +0900</pubDate><guid>https://Kenta11.github.io/posts/2022-09-23-micro1/</guid><description>&amp;lt;no value&amp;gt;</description><content type="text/html" mode="escaped"><![CDATA[<h2 id="ã¯ã˜ã‚ã«">ã¯ã˜ã‚ã«<a href="#%e3%81%af%e3%81%98%e3%82%81%e3%81%ab" class="anchor" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"
      stroke-linecap="round" stroke-linejoin="round">
      <path d="M15 7h3a5 5 0 0 1 5 5 5 5 0 0 1-5 5h-3m-6 0H6a5 5 0 0 1-5-5 5 5 0 0 1 5-5h3"></path>
      <line x1="8" y1="12" x2="16" y2="12"></line>
   </svg></a></h2>
<p>ã€€å‡ºèº«å­¦ç§‘ã‚‚å‡ºèº«å°‚æ”»ã‚‚ï¼Œå®Œå…¨ã«åç§°ãŒç„¡ããªã£ã¦ã—ã¾ã„ã¾ã—ãŸã­ï¼
éã”ã—ãŸæ™‚é–“ã«æ€ã„ã‚’é¦³ã›ãªãŒã‚‰ï¼Œãƒã‚¤ã‚¯ãƒ­ãƒ—ãƒ­ã‚°ãƒ©ãƒŸãƒ³ã‚°ã‚’ã—ã¾ã—ã‚‡ã†ï¼ˆæ€¥å±•é–‹ï¼‰ï¼</p>
<h2 id="ã‚¢ã‚»ãƒ³ãƒ–ãƒ©">ã‚¢ã‚»ãƒ³ãƒ–ãƒ©<a href="#%e3%82%a2%e3%82%bb%e3%83%b3%e3%83%96%e3%83%a9" class="anchor" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"
      stroke-linecap="round" stroke-linejoin="round">
      <path d="M15 7h3a5 5 0 0 1 5 5 5 5 0 0 1-5 5h-3m-6 0H6a5 5 0 0 1-5-5 5 5 0 0 1 5-5h3"></path>
      <line x1="8" y1="12" x2="16" y2="12"></line>
   </svg></a></h2>
<h3 id="ä¸€è¦§">ä¸€è¦§<a href="#%e4%b8%80%e8%a6%a7" class="anchor" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"
      stroke-linecap="round" stroke-linejoin="round">
      <path d="M15 7h3a5 5 0 0 1 5 5 5 5 0 0 1-5 5h-3m-6 0H6a5 5 0 0 1-5-5 5 5 0 0 1 5-5h3"></path>
      <line x1="8" y1="12" x2="16" y2="12"></line>
   </svg></a></h3>
<ul>
<li>æ©Ÿæ¢°èªã‚¢ã‚»ãƒ³ãƒ–ãƒ©: <a href="https://github.com/Kenta11/rm1asm">rm1asm</a></li>
<li>ãƒã‚¤ã‚¯ãƒ­ã‚¢ã‚»ãƒ³ãƒ–ãƒ©: <a href="https://github.com/Kenta11/rm1masm">rm1masm</a></li>
</ul>
<h3 id="ç‰¹å¾´">ç‰¹å¾´<a href="#%e7%89%b9%e5%be%b4" class="anchor" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"
      stroke-linecap="round" stroke-linejoin="round">
      <path d="M15 7h3a5 5 0 0 1 5 5 5 5 0 0 1-5 5h-3m-6 0H6a5 5 0 0 1-5-5 5 5 0 0 1 5-5h3"></path>
      <line x1="8" y1="12" x2="16" y2="12"></line>
   </svg></a></h3>
<ul>
<li>Unicodeå¯¾å¿œ</li>
<li>ãƒãƒ«ãƒãƒ—ãƒ©ãƒƒãƒˆãƒ•ã‚©ãƒ¼ãƒ ã§å‹•ä½œï¼ˆWindowsï¼ŒLinuxï¼ŒMacOSï¼‰</li>
<li>ã‚¨ãƒ©ãƒ¼è¡¨ç¤ºæ©Ÿèƒ½ä»˜ãï¼ˆæœŸå¾…ã«æ·»ãˆã‚‹ç¨‹ã®ã‚¯ã‚ªãƒªãƒ†ã‚£<strong>ã§ã¯ãªã„</strong>ï¼‰</li>
</ul>
<h2 id="éŠã³æ–¹">éŠã³æ–¹<a href="#%e9%81%8a%e3%81%b3%e6%96%b9" class="anchor" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"
      stroke-linecap="round" stroke-linejoin="round">
      <path d="M15 7h3a5 5 0 0 1 5 5 5 5 0 0 1-5 5h-3m-6 0H6a5 5 0 0 1-5-5 5 5 0 0 1 5-5h3"></path>
      <line x1="8" y1="12" x2="16" y2="12"></line>
   </svg></a></h2>
<p>ã€€ã¾ãšã¯ã‚¢ã‚»ãƒ³ãƒ–ãƒ©ã¨ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚¿ã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã—ã¦ä¸‹ã•ã„ï¼
ã‚¢ã‚»ãƒ³ãƒ–ãƒ©ã¯<code>cargo install</code>ã§ã‚‚ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã§ãã¾ã™ãŒï¼Œç‰¹ã«Linuxã‚’ãŠä½¿ã„ã®æ–¹ã¯<a href="https://github.com/Kenta11/rm1asm/releases/tag/v1.0.0">ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸</a>ã‹ã‚‰ã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ãŒä¾¿åˆ©ã§ã™ï¼
ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚¿ã¯Windowsãƒ¦ãƒ¼ã‚¶ãªã‚‰å…¬å¼ï¼ˆï¼Ÿï¼‰ã«é…å¸ƒã•ã‚Œã¦ã„ã‚‹ã‚‚ã®ã‚’ä½¿ã„ã¾ã—ã‚‡ã†ï¼
ãã‚Œä»¥å¤–ã®æ–¹ã¯è‡ªå‰ã§ãƒ“ãƒ«ãƒ‰ã—ã¦ä¸‹ã•ã„ï¼</p>
<pre tabindex="0"><code>$ git clone https://github.com/Kenta11/micro1
$ cd micro1
$ gcc m1sim.c -o m1sim
</code></pre><p>ã€€MICRO-1ã®ãƒã‚¤ã‚¯ãƒ­ãƒ—ãƒ­ã‚°ãƒ©ãƒ ã‚’ã‚¢ã‚»ãƒ³ãƒ–ãƒ«ã—ã¾ã™ï¼</p>
<pre tabindex="0"><code>$ curl -s http://www.ced.is.utsunomiya-u.ac.jp/lecture/2022/jikkenb/micro/chap5/MICROONE | iconv -f sjis -t utf8 | tr -d &#34;\32&#34; &gt; MICROONE
$ rm1masm MICROONE -o MICROONE.o
</code></pre><p>ã€€ç¶šã„ã¦æ©Ÿæ¢°èªãƒ—ãƒ­ã‚°ãƒ©ãƒ ã‚’ã‚¢ã‚»ãƒ³ãƒ–ãƒ«ã—ã¾ã™ï¼</p>
<pre tabindex="0"><code>$ cat sqrt
; This program is distributed under MIT LICENSE.
; Copyright (c) 2022 Kenta Arai
; å¹³æ–¹æ ¹ã‚’æ±‚ã‚ã‚‹ãƒ—ãƒ­ã‚°ãƒ©ãƒ 
; ã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ ã¯&#34;ãƒãƒ“ãƒ­ãƒ‹ã‚¢äººã®æ–¹æ³•&#34;ã§ã‚ã‚‹

TITLE SQRT
         L   1, X0
         L   3, ERROR
; X(n+1)ã‚’è¨ˆç®—
HEAD:    LEA 2, (1)
         LC  0, 0
         L   1, S
         BSR CALCXN1
; |X(n+1) - X(n)| &lt; ERROR ã®å ´åˆã¯è¨ˆç®—ã‚’çµ‚äº†ã™ã‚‹
         SUB 2, (1)   ; X(n) - X(n+1)
         BSR ABS      ; |X(n+1) - X(n)|
         SUB 2, (3)   ; |X(n+1) - X(n)| - ERROR
         BNM HEAD
; è§£ã‚’ä¿å­˜ã—ï¼Œãƒ—ãƒ­ã‚°ãƒ©ãƒ ã‚’çµ‚äº†
         ST  1, XN
         HLT

S:       DC  487      ; å…¥åŠ›
X0:      DC  20       ; åˆæœŸå€¤X(0)
ERROR:   DC  5        ; ã‚¨ãƒ©ãƒ¼
XN:      DS  1        ; è§£X(n)

; X(n+1)ã‚’è¨ˆç®—ã™ã‚‹é–¢æ•°
; å…¥åŠ›: {r0: 0, r1: S, r2: X(n)}
; å‡ºåŠ›: {r1: X(n+1), r2: X(n)}
CALCXN1: DIV 0, (2)   ; S/X(n)
         ADD 1, (2)   ; S/X(n) + X(n)
         SA  1, -1    ; (S/X(n) + X(n)) / 2 = X(n+1)
         RET

; çµ¶å¯¾å€¤ã‚’è¨ˆç®—ã™ã‚‹é–¢æ•°
; å…¥åŠ›: {r2: æ•´æ•°}
; å‡ºåŠ›: {r2: çµ¶å¯¾å€¤}
ABS:     CMP 2, 0
         BNM ABS0
         XOR 2, X&#34;FFFF
         ADD 2, 1
ABS0:    RET 
END
$ rm1asm sqrt -o sqrt.b
</code></pre><p>ã€€ãƒ—ãƒ­ã‚°ãƒ©ãƒ ã‚’å®Ÿè¡Œã—ã¦ã¿ã¾ã—ã‚‡ã†ï¼</p>
<pre tabindex="0"><code>$ ./m1sim

   *** MICRO-1 SIMULATOR (C-Ver. 1.0d) [Sep 23 2022] ***

&gt;&gt; load
LOAD
  FILE NAME=?MICROONE.o
  LOADING &#39;MICROONE.o&#39;
 LOADED TO CM
&gt;&gt; load       
LOAD
  FILE NAME=?sqrt.b
  LOADING &#39;sqrt.b&#39;
 LOADED TO MM
&gt;&gt; trace
TRACE
  T?device
   TD?set
   DEVICE ?pc
   DEVICE ?ir
   DEVICE ?flag
   DEVICE ?r0
   DEVICE ?r1
   DEVICE ?r2
   DEVICE ?r3
   DEVICE ?lbus
   DEVICE ?rbus
   DEVICE ?abus
   DEVICE ?sbus
   DEVICE ?.
   TD?.

  T?go
 CMAR=?101
 MAX STEP=?300
CMAR  PC   IR  ZNCOCT  R0   R1   R2   R3  LBUS RBUS ABUS SBUS 
102  0000 0000 000010 0000 0000 0000 0000 0000 0040 0040 0040 
ï½ä¸­ç•¥ï½
CMAR  PC   IR  ZNCOCT  R0   R1   R2   R3  LBUS RBUS ABUS SBUS 
0FD  000C EF00 000010 0007 0016 FFFD 0005 0000 0000 0000 0000 
 CPU HALTED !
  259 STEPS USED
  T?.
&gt;&gt; dump
DUMP
  D?mm
    START ADRS ?000C
    END   ADRS ?000F
000C:01E7
000D:0014
000E:0005
000F:0016
  D?.
&gt;&gt; end
&gt;&gt;   MICRO-1 TERMINATED
</code></pre><p>ã€€XN(ã‚¢ãƒ‰ãƒ¬ã‚¹ãŒ0x000Fã®è¡Œ)ã«487ã®å¤§ä½“ã®å¹³æ–¹æ ¹22(0x0016)ãŒæ ¼ç´ã•ã‚Œã¦ã„ã¾ã™ã­ï¼
å¤§å¤§å¤§æˆåŠŸã§ã™ï¼</p>
<h2 id="ãŠã‚ã‚Šã«">ãŠã‚ã‚Šã«<a href="#%e3%81%8a%e3%82%8f%e3%82%8a%e3%81%ab" class="anchor" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"
      stroke-linecap="round" stroke-linejoin="round">
      <path d="M15 7h3a5 5 0 0 1 5 5 5 5 0 0 1-5 5h-3m-6 0H6a5 5 0 0 1-5-5 5 5 0 0 1 5-5h3"></path>
      <line x1="8" y1="12" x2="16" y2="12"></line>
   </svg></a></h2>
<p>ã€€Rustè£½ã®è¨€èªå‡¦ç†ç³»ãƒ©ã‚¤ãƒ–ãƒ©ãƒªï¼ˆlogosã¨chumskyï¼‰ã§éŠã‚“ã§ã„ãŸã‚‰ï¼Œã„ã¤ã®é–“ã«ã‹ã‚¢ã‚»ãƒ³ãƒ–ãƒ©ã‚’æ›¸ã„ã¦ã„ãŸï¼
ä½•ã‚’è¨€ã£ã¦ã„ã‚‹ã®ã‹ ã‚ã‹ã‚‰ã­ãƒ¼ã¨æ€ã†ãŒï¼ˆä»¥ä¸‹ç•¥ï¼‰</p>
<p>ã€€MICRO-1ãŒæ›¸ã‹ã‚ŒãŸæ›¸ç±ã¯çµ¶ç‰ˆã ã—ï¼Œã“ã®ã¾ã¾æˆæ¥­ã‚‚ç„¡ããªã£ã¦ã—ã¾ã£ãŸã‚‰æ‚²ã—ã„ã§ã™ã­ï¼
ã‚¢ã‚»ãƒ³ãƒ–ãƒ©ã¯GitHubã«ç½®ã„ã¦ãŠã‘ã°ã—ã°ã‚‰ãã¯æ®‹ã‚‹ã¨æ€ã†ã®ã§ï¼Œæ­´å²çš„ãªã‚¢ãƒ¬ã‚³ãƒ¬ã¨ã—ã¦èª°ã‹æ´»ç”¨ã—ã¦ä¸‹ã•ã„ï¼</p>
<p>ã€€P.S. ã‚µãƒ³ãƒ—ãƒ«ãƒ—ãƒ­ã‚°ãƒ©ãƒ ã®ãƒ©ã‚¤ã‚»ãƒ³ã‚¹ãŒä¸æ˜ãªã®ã§ï¼Œæœ¬å®¶ã‹ã‚‰ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã§ããªããªã£ãŸã‚‰ã©ã†ã—ã‚ˆã†&hellip;</p>
<p>ãŠã—ã¾ã„</p>
]]></content></item></channel></rss>