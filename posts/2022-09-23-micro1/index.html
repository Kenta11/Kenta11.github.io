<!doctype html><html lang=en-us><head><meta charset=UTF-8><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta http-equiv=X-UA-Compatible content="ie=edge"><meta name=robots content="index, follow"><meta name=author content><meta name=description content><link rel=author type=text/plain href=/humans.txt><link rel=apple-touch-icon sizes=180x180 href=/apple-touch-icon.png><link rel=icon href=/favicon.ico type=image/x-icon><link rel=icon type=image/png sizes=32x32 href=/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=/favicon-16x16.png><link rel=manifest href=/site.webmanifest><meta name=msapplication-TileImage content="/mstile-144x144.png"><meta name=theme-color content="#494f5c"><meta name=msapplication-TileColor content="#494f5c"><link rel=mask-icon href=/safari-pinned-tab.svg color=#494f5c><meta itemprop=name content="情報工学実験II（再履修）"><meta itemprop=description content="はじめに 出身学科も出身専攻も，完全に名称が無くなってしまいましたね． 過ごした時間に思いを馳せながら，マイクロプログラミングをしましょう（急展開）．"><meta itemprop=datePublished content="2022-09-23T22:00:00+09:00"><meta itemprop=dateModified content="2022-09-23T22:00:00+09:00"><meta itemprop=wordCount content="1158"><meta itemprop=keywords content="MICRO-1,Rust"><meta property="og:url" content="https://Kenta11.github.io/posts/2022-09-23-micro1/"><meta property="og:site_name" content="Kenta Arai Webpage"><meta property="og:title" content="情報工学実験II（再履修）"><meta property="og:description" content="はじめに 出身学科も出身専攻も，完全に名称が無くなってしまいましたね． 過ごした時間に思いを馳せながら，マイクロプログラミングをしましょう（急展開）．"><meta property="og:locale" content="en_us"><meta property="og:type" content="article"><meta property="article:section" content="posts"><meta property="article:published_time" content="2022-09-23T22:00:00+09:00"><meta property="article:modified_time" content="2022-09-23T22:00:00+09:00"><meta property="article:tag" content="MICRO-1"><meta property="article:tag" content="Rust"><meta name=twitter:card content="summary"><meta name=twitter:title content="情報工学実験II（再履修）"><meta name=twitter:description content="はじめに 出身学科も出身専攻も，完全に名称が無くなってしまいましたね． 過ごした時間に思いを馳せながら，マイクロプログラミングをしましょう（急展開）．"><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"情報工学実験II（再履修）","name":"情報工学実験II（再履修）","description":"はじめに 出身学科も出身専攻も，完全に名称が無くなってしまいましたね． 過ごした時間に思いを馳せながら，マイクロプログラミングをしましょう（急展開）．\n","keywords":["MICRO-1","Rust"],"articleBody":"はじめに 出身学科も出身専攻も，完全に名称が無くなってしまいましたね． 過ごした時間に思いを馳せながら，マイクロプログラミングをしましょう（急展開）．\nアセンブラ 一覧 機械語アセンブラ: rm1asm マイクロアセンブラ: rm1masm 特徴 Unicode対応 マルチプラットフォームで動作（Windows，Linux，MacOS） エラー表示機能付き（期待に添える程のクオリティではない） 遊び方 まずはアセンブラとシミュレータをインストールして下さい． アセンブラはcargo installでもインストールできますが，特にLinuxをお使いの方はパッケージからのインストールが便利です． シミュレータはWindowsユーザなら公式（？）に配布されているものを使いましょう． それ以外の方は自前でビルドして下さい．\n$ git clone https://github.com/Kenta11/micro1 $ cd micro1 $ gcc m1sim.c -o m1sim MICRO-1のマイクロプログラムをアセンブルします．\n$ curl -s http://www.ced.is.utsunomiya-u.ac.jp/lecture/2022/jikkenb/micro/chap5/MICROONE | iconv -f sjis -t utf8 | tr -d \"\\32\" \u003e MICROONE $ rm1masm MICROONE -o MICROONE.o 続いて機械語プログラムをアセンブルします．\n$ cat sqrt ; This program is distributed under MIT LICENSE. ; Copyright (c) 2022 Kenta Arai ; 平方根を求めるプログラム ; アルゴリズムは\"バビロニア人の方法\"である TITLE SQRT L 1, X0 L 3, ERROR ; X(n+1)を計算 HEAD: LEA 2, (1) LC 0, 0 L 1, S BSR CALCXN1 ; |X(n+1) - X(n)| \u003c ERROR の場合は計算を終了する SUB 2, (1) ; X(n) - X(n+1) BSR ABS ; |X(n+1) - X(n)| SUB 2, (3) ; |X(n+1) - X(n)| - ERROR BNM HEAD ; 解を保存し，プログラムを終了 ST 1, XN HLT S: DC 487 ; 入力 X0: DC 20 ; 初期値X(0) ERROR: DC 5 ; エラー XN: DS 1 ; 解X(n) ; X(n+1)を計算する関数 ; 入力: {r0: 0, r1: S, r2: X(n)} ; 出力: {r1: X(n+1), r2: X(n)} CALCXN1: DIV 0, (2) ; S/X(n) ADD 1, (2) ; S/X(n) + X(n) SA 1, -1 ; (S/X(n) + X(n)) / 2 = X(n+1) RET ; 絶対値を計算する関数 ; 入力: {r2: 整数} ; 出力: {r2: 絶対値} ABS: CMP 2, 0 BNM ABS0 XOR 2, X\"FFFF ADD 2, 1 ABS0: RET END $ rm1asm sqrt -o sqrt.b プログラムを実行してみましょう．\n$ ./m1sim *** MICRO-1 SIMULATOR (C-Ver. 1.0d) [Sep 23 2022] *** \u003e\u003e load LOAD FILE NAME=?MICROONE.o LOADING 'MICROONE.o' LOADED TO CM \u003e\u003e load LOAD FILE NAME=?sqrt.b LOADING 'sqrt.b' LOADED TO MM \u003e\u003e trace TRACE T?device TD?set DEVICE ?pc DEVICE ?ir DEVICE ?flag DEVICE ?r0 DEVICE ?r1 DEVICE ?r2 DEVICE ?r3 DEVICE ?lbus DEVICE ?rbus DEVICE ?abus DEVICE ?sbus DEVICE ?. TD?. T?go CMAR=?101 MAX STEP=?300 CMAR PC IR ZNCOCT R0 R1 R2 R3 LBUS RBUS ABUS SBUS 102 0000 0000 000010 0000 0000 0000 0000 0000 0040 0040 0040 ～中略～ CMAR PC IR ZNCOCT R0 R1 R2 R3 LBUS RBUS ABUS SBUS 0FD 000C EF00 000010 0007 0016 FFFD 0005 0000 0000 0000 0000 CPU HALTED ! 259 STEPS USED T?. \u003e\u003e dump DUMP D?mm START ADRS ?000C END ADRS ?000F 000C:01E7 000D:0014 000E:0005 000F:0016 D?. \u003e\u003e end \u003e\u003e MICRO-1 TERMINATED XN(アドレスが0x000Fの行)に487の大体の平方根22(0x0016)が格納されていますね． 大大大成功です．\nおわりに Rust製の言語処理系ライブラリ（logosとchumsky）で遊んでいたら，いつの間にかアセンブラを書いていた． 何を言っているのか わからねーと思うが（以下略）\nMICRO-1が書かれた書籍は絶版だし，このまま授業も無くなってしまったら悲しいですね． アセンブラはGitHubに置いておけばしばらくは残ると思うので，歴史的なアレコレとして誰か活用して下さい．\nP.S. サンプルプログラムのライセンスが不明なので，本家からダウンロードできなくなったらどうしよう…\nおしまい\n","wordCount":"1158","inLanguage":"en","datePublished":"2022-09-23T22:00:00+09:00","dateModified":"2022-09-23T22:00:00+09:00","author":{"@type":"Person","name":null},"mainEntityOfPage":{"@type":"WebPage","@id":"https://Kenta11.github.io/posts/2022-09-23-micro1/"},"publisher":{"@type":"Organization","name":"Kenta Arai Webpage","description":"","logo":{"@type":"ImageObject","url":"https://Kenta11.github.io/favicon.ico"}}}</script><title>情報工学実験II（再履修）</title>
<link rel="stylesheet dns-prefetch preconnect preload prefetch" as=style href=https://Kenta11.github.io/css/style.min.d3facc2d5fe42af72ee5a80584900a45ffee6035df0ef582bd8696c2fe0c9da5.css integrity="sha256-0/rMLV/kKvcu5agFhJAKRf/uYDXfDvWCvYaWwv4MnaU=" crossorigin=anonymous></head><body id=page><header id=site-header class="animated slideInUp"><div class="hdr-wrapper section-inner"><div class=hdr-left><div class=site-branding><a href=https://Kenta11.github.io/>Kenta Arai Webpage</a></div><nav class="site-nav hide-in-mobile"><a href=https://Kenta11.github.io/posts/>Posts</a><a href=https://Kenta11.github.io/about/>About</a><a href=https://Kenta11.github.io/projects/>Projects</a></nav></div><div class="hdr-right hdr-icons"><button id=toc-btn class="hdr-btn desktop-only-ib" title><svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-list"><line x1="8" y1="6" x2="21" y2="6"/><line x1="8" y1="12" x2="21" y2="12"/><line x1="8" y1="18" x2="21" y2="18"/><line x1="3" y1="6" x2="3" y2="6"/><line x1="3" y1="12" x2="3" y2="12"/><line x1="3" y1="18" x2="3" y2="18"/></svg></button><span class="hdr-social hide-in-mobile"><a href=https://twitter.com/isKenta14 target=_blank rel="noopener me" title=Twitter><svg class="feather" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M23 3a10.9 10.9.0 01-3.14 1.53 4.48 4.48.0 00-7.86 3v1A10.66 10.66.0 013 4s-4 9 5 13a11.64 11.64.0 01-7 2c9 5 20 0 20-11.5a4.5 4.5.0 00-.08-.83A7.72 7.72.0 0023 3z"/></svg></a><a href=https://github.com/Kenta11 target=_blank rel="noopener me" title=Github><svg class="feather" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M9 19c-5 1.5-5-2.5-7-3m14 6v-3.87a3.37 3.37.0 00-.94-2.61c3.14-.35 6.44-1.54 6.44-7A5.44 5.44.0 0020 4.77 5.07 5.07.0 0019.91 1S18.73.65 16 2.48a13.38 13.38.0 00-7 0C6.27.65 5.09 1 5.09 1A5.07 5.07.0 005 4.77 5.44 5.44.0 003.5 8.55c0 5.42 3.3 6.61 6.44 7A3.37 3.37.0 009 18.13V22"/></svg></a><a href=https://gitlab.com/Kenta111 target=_blank rel="noopener me" title=Gitlab><svg class="feather" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M22.65 14.39 12 22.13 1.35 14.39a.84.84.0 01-.3-.94l1.22-3.78 2.44-7.51A.42.42.0 014.82 2a.43.43.0 01.58.0.42.42.0 01.11.18l2.44 7.49h8.1l2.44-7.51A.42.42.0 0118.6 2a.43.43.0 01.58.0.42.42.0 01.11.18l2.44 7.51L23 13.45a.84.84.0 01-.35.94z"/></svg></a><a href=https://qiita.com/Kenta11 target=_blank rel="noopener me" title=Qiita><svg class="feather feather-link" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 007.54.54l3-3a5 5 0 00-7.07-7.07l-1.72 1.71"/><path d="M14 11a5 5 0 00-7.54-.54l-3 3a5 5 0 007.07 7.07l1.71-1.71"/></svg></a><a href=https://speakerdeck.com/kenta11 target=_blank rel="noopener me" title=Speakerdeck><svg class="feather feather-link" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 007.54.54l3-3a5 5 0 00-7.07-7.07l-1.72 1.71"/><path d="M14 11a5 5 0 00-7.54-.54l-3 3a5 5 0 007.07 7.07l1.71-1.71"/></svg></a></span><button id=menu-btn class=hdr-btn title><svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-menu"><line x1="3" y1="12" x2="21" y2="12"/><line x1="3" y1="6" x2="21" y2="6"/><line x1="3" y1="18" x2="21" y2="18"/></svg></button></div></div></header><div id=mobile-menu class="animated fast"><ul><li><a href=https://Kenta11.github.io/posts/>Posts</a></li><li><a href=https://Kenta11.github.io/about/>About</a></li><li><a href=https://Kenta11.github.io/projects/>Projects</a></li></ul></div><main class="site-main section-inner animated fadeIn faster"><article class=thin><header class=post-header><div class=post-date><span>Sep 23, 2022</span></div><h1>情報工学実験II（再履修）</h1></header><div class=post-description><p><svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-tag meta-icon"><path d="M20.59 13.41l-7.17 7.17a2 2 0 01-2.83.0L2 12V2h10l8.59 8.59a2 2 0 010 2.82z"/><line x1="7" y1="7" x2="7" y2="7"/></svg><span class=tag><a href=https://Kenta11.github.io/tags/micro-1>MICRO-1</a></span><span class=tag><a href=https://Kenta11.github.io/tags/rust>Rust</a></span></p><p><svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-file-text"><path d="M14 2H6A2 2 0 004 4v16a2 2 0 002 2h12a2 2 0 002-2V8z"/><polyline points="14 2 14 8 20 8"/><line x1="16" y1="13" x2="8" y2="13"/><line x1="16" y1="17" x2="8" y2="17"/><polyline points="10 9 9 9 8 9"/></svg>1158&nbspWords</p><p><svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-calendar"><rect x="3" y="4" width="18" height="18" rx="2" ry="2"/><line x1="16" y1="2" x2="16" y2="6"/><line x1="8" y1="2" x2="8" y2="6"/><line x1="3" y1="10" x2="21" y2="10"/></svg>2022-09-23 13:00 +0000</p></div><hr class=post-end><div class=content><h2 id=はじめに>はじめに<a href=#%e3%81%af%e3%81%98%e3%82%81%e3%81%ab class=anchor aria-hidden=true><svg viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M15 7h3a5 5 0 015 5 5 5 0 01-5 5h-3m-6 0H6a5 5 0 01-5-5 5 5 0 015-5h3"/><line x1="8" y1="12" x2="16" y2="12"/></svg></a></h2><p>　出身学科も出身専攻も，完全に名称が無くなってしまいましたね．
過ごした時間に思いを馳せながら，マイクロプログラミングをしましょう（急展開）．</p><h2 id=アセンブラ>アセンブラ<a href=#%e3%82%a2%e3%82%bb%e3%83%b3%e3%83%96%e3%83%a9 class=anchor aria-hidden=true><svg viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M15 7h3a5 5 0 015 5 5 5 0 01-5 5h-3m-6 0H6a5 5 0 01-5-5 5 5 0 015-5h3"/><line x1="8" y1="12" x2="16" y2="12"/></svg></a></h2><h3 id=一覧>一覧<a href=#%e4%b8%80%e8%a6%a7 class=anchor aria-hidden=true><svg viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M15 7h3a5 5 0 015 5 5 5 0 01-5 5h-3m-6 0H6a5 5 0 01-5-5 5 5 0 015-5h3"/><line x1="8" y1="12" x2="16" y2="12"/></svg></a></h3><ul><li>機械語アセンブラ: <a href=https://github.com/Kenta11/rm1asm>rm1asm</a></li><li>マイクロアセンブラ: <a href=https://github.com/Kenta11/rm1masm>rm1masm</a></li></ul><h3 id=特徴>特徴<a href=#%e7%89%b9%e5%be%b4 class=anchor aria-hidden=true><svg viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M15 7h3a5 5 0 015 5 5 5 0 01-5 5h-3m-6 0H6a5 5 0 01-5-5 5 5 0 015-5h3"/><line x1="8" y1="12" x2="16" y2="12"/></svg></a></h3><ul><li>Unicode対応</li><li>マルチプラットフォームで動作（Windows，Linux，MacOS）</li><li>エラー表示機能付き（期待に添える程のクオリティ<strong>ではない</strong>）</li></ul><h2 id=遊び方>遊び方<a href=#%e9%81%8a%e3%81%b3%e6%96%b9 class=anchor aria-hidden=true><svg viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M15 7h3a5 5 0 015 5 5 5 0 01-5 5h-3m-6 0H6a5 5 0 01-5-5 5 5 0 015-5h3"/><line x1="8" y1="12" x2="16" y2="12"/></svg></a></h2><p>　まずはアセンブラとシミュレータをインストールして下さい．
アセンブラは<code>cargo install</code>でもインストールできますが，特にLinuxをお使いの方は<a href=https://github.com/Kenta11/rm1asm/releases/tag/v1.0.0>パッケージ</a>からのインストールが便利です．
シミュレータはWindowsユーザなら公式（？）に配布されているものを使いましょう．
それ以外の方は自前でビルドして下さい．</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>$ git clone https://github.com/Kenta11/micro1
</span></span><span class=line><span class=cl>$ <span class=nb>cd</span> micro1
</span></span><span class=line><span class=cl>$ gcc m1sim.c -o m1sim
</span></span></code></pre></div><p>　MICRO-1のマイクロプログラムをアセンブルします．</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>$ curl -s http://www.ced.is.utsunomiya-u.ac.jp/lecture/2022/jikkenb/micro/chap5/MICROONE <span class=p>|</span> iconv -f sjis -t utf8 <span class=p>|</span> tr -d <span class=s2>&#34;\32&#34;</span> &gt; MICROONE
</span></span><span class=line><span class=cl>$ rm1masm MICROONE -o MICROONE.o
</span></span></code></pre></div><p>　続いて機械語プログラムをアセンブルします．</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>$ cat sqrt
</span></span><span class=line><span class=cl><span class=p>;</span> This program is distributed under MIT LICENSE.
</span></span><span class=line><span class=cl><span class=p>;</span> Copyright <span class=o>(</span>c<span class=o>)</span> <span class=m>2022</span> Kenta Arai
</span></span><span class=line><span class=cl><span class=p>;</span> 平方根を求めるプログラム
</span></span><span class=line><span class=cl><span class=p>;</span> アルゴリズムは<span class=s2>&#34;バビロニア人の方法&#34;</span>である
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>TITLE SQRT
</span></span><span class=line><span class=cl>         L   1, X0
</span></span><span class=line><span class=cl>         L   3, ERROR
</span></span><span class=line><span class=cl><span class=p>;</span> X<span class=o>(</span>n+1<span class=o>)</span>を計算
</span></span><span class=line><span class=cl>HEAD:    LEA 2, <span class=o>(</span>1<span class=o>)</span>
</span></span><span class=line><span class=cl>         LC  0, <span class=m>0</span>
</span></span><span class=line><span class=cl>         L   1, S
</span></span><span class=line><span class=cl>         BSR CALCXN1
</span></span><span class=line><span class=cl><span class=p>;</span> <span class=p>|</span>X<span class=o>(</span>n+1<span class=o>)</span> - X<span class=o>(</span>n<span class=o>)</span><span class=p>|</span> &lt; ERROR の場合は計算を終了する
</span></span><span class=line><span class=cl>         SUB 2, <span class=o>(</span>1<span class=o>)</span>   <span class=p>;</span> X<span class=o>(</span>n<span class=o>)</span> - X<span class=o>(</span>n+1<span class=o>)</span>
</span></span><span class=line><span class=cl>         BSR ABS      <span class=p>;</span> <span class=p>|</span>X<span class=o>(</span>n+1<span class=o>)</span> - X<span class=o>(</span>n<span class=o>)</span><span class=p>|</span>
</span></span><span class=line><span class=cl>         SUB 2, <span class=o>(</span>3<span class=o>)</span>   <span class=p>;</span> <span class=p>|</span>X<span class=o>(</span>n+1<span class=o>)</span> - X<span class=o>(</span>n<span class=o>)</span><span class=p>|</span> - ERROR
</span></span><span class=line><span class=cl>         BNM HEAD
</span></span><span class=line><span class=cl><span class=p>;</span> 解を保存し，プログラムを終了
</span></span><span class=line><span class=cl>         ST  1, XN
</span></span><span class=line><span class=cl>         HLT
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>S:       DC  <span class=m>487</span>      <span class=p>;</span> 入力
</span></span><span class=line><span class=cl>X0:      DC  <span class=m>20</span>       <span class=p>;</span> 初期値X<span class=o>(</span>0<span class=o>)</span>
</span></span><span class=line><span class=cl>ERROR:   DC  <span class=m>5</span>        <span class=p>;</span> エラー
</span></span><span class=line><span class=cl>XN:      DS  <span class=m>1</span>        <span class=p>;</span> 解X<span class=o>(</span>n<span class=o>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>;</span> X<span class=o>(</span>n+1<span class=o>)</span>を計算する関数
</span></span><span class=line><span class=cl><span class=p>;</span> 入力: <span class=o>{</span>r0: 0, r1: S, r2: X<span class=o>(</span>n<span class=o>)}</span>
</span></span><span class=line><span class=cl><span class=p>;</span> 出力: <span class=o>{</span>r1: X<span class=o>(</span>n+1<span class=o>)</span>, r2: X<span class=o>(</span>n<span class=o>)}</span>
</span></span><span class=line><span class=cl>CALCXN1: DIV 0, <span class=o>(</span>2<span class=o>)</span>   <span class=p>;</span> S/X<span class=o>(</span>n<span class=o>)</span>
</span></span><span class=line><span class=cl>         ADD 1, <span class=o>(</span>2<span class=o>)</span>   <span class=p>;</span> S/X<span class=o>(</span>n<span class=o>)</span> + X<span class=o>(</span>n<span class=o>)</span>
</span></span><span class=line><span class=cl>         SA  1, -1    <span class=p>;</span> <span class=o>(</span>S/X<span class=o>(</span>n<span class=o>)</span> + X<span class=o>(</span>n<span class=o>))</span> / <span class=nv>2</span> <span class=o>=</span> X<span class=o>(</span>n+1<span class=o>)</span>
</span></span><span class=line><span class=cl>         RET
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>;</span> 絶対値を計算する関数
</span></span><span class=line><span class=cl><span class=p>;</span> 入力: <span class=o>{</span>r2: 整数<span class=o>}</span>
</span></span><span class=line><span class=cl><span class=p>;</span> 出力: <span class=o>{</span>r2: 絶対値<span class=o>}</span>
</span></span><span class=line><span class=cl>ABS:     CMP 2, <span class=m>0</span>
</span></span><span class=line><span class=cl>         BNM ABS0
</span></span><span class=line><span class=cl>         XOR 2, X<span class=s2>&#34;FFFF
</span></span></span><span class=line><span class=cl><span class=s2>         ADD 2, 1
</span></span></span><span class=line><span class=cl><span class=s2>ABS0:    RET 
</span></span></span><span class=line><span class=cl><span class=s2>END
</span></span></span><span class=line><span class=cl><span class=s2></span>$<span class=s2> rm1asm sqrt -o sqrt.b
</span></span></span></code></pre></div><p>　プログラムを実行してみましょう．</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>$ ./m1sim
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>   *** MICRO-1 SIMULATOR <span class=o>(</span>C-Ver. 1.0d<span class=o>)</span> <span class=o>[</span>Sep <span class=m>23</span> 2022<span class=o>]</span> ***
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>&gt;&gt; load
</span></span><span class=line><span class=cl>LOAD
</span></span><span class=line><span class=cl>  FILE <span class=nv>NAME</span><span class=o>=</span>?MICROONE.o
</span></span><span class=line><span class=cl>  LOADING <span class=s1>&#39;MICROONE.o&#39;</span>
</span></span><span class=line><span class=cl> LOADED TO CM
</span></span><span class=line><span class=cl>&gt;&gt; load       
</span></span><span class=line><span class=cl>LOAD
</span></span><span class=line><span class=cl>  FILE <span class=nv>NAME</span><span class=o>=</span>?sqrt.b
</span></span><span class=line><span class=cl>  LOADING <span class=s1>&#39;sqrt.b&#39;</span>
</span></span><span class=line><span class=cl> LOADED TO MM
</span></span><span class=line><span class=cl>&gt;&gt; trace
</span></span><span class=line><span class=cl>TRACE
</span></span><span class=line><span class=cl>  T?device
</span></span><span class=line><span class=cl>   TD?set
</span></span><span class=line><span class=cl>   DEVICE ?pc
</span></span><span class=line><span class=cl>   DEVICE ?ir
</span></span><span class=line><span class=cl>   DEVICE ?flag
</span></span><span class=line><span class=cl>   DEVICE ?r0
</span></span><span class=line><span class=cl>   DEVICE ?r1
</span></span><span class=line><span class=cl>   DEVICE ?r2
</span></span><span class=line><span class=cl>   DEVICE ?r3
</span></span><span class=line><span class=cl>   DEVICE ?lbus
</span></span><span class=line><span class=cl>   DEVICE ?rbus
</span></span><span class=line><span class=cl>   DEVICE ?abus
</span></span><span class=line><span class=cl>   DEVICE ?sbus
</span></span><span class=line><span class=cl>   DEVICE ?.
</span></span><span class=line><span class=cl>   TD?.
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  T?go
</span></span><span class=line><span class=cl> <span class=nv>CMAR</span><span class=o>=</span>?101
</span></span><span class=line><span class=cl> MAX <span class=nv>STEP</span><span class=o>=</span>?300
</span></span><span class=line><span class=cl>CMAR  PC   IR  ZNCOCT  R0   R1   R2   R3  LBUS RBUS ABUS SBUS 
</span></span><span class=line><span class=cl><span class=m>102</span>  <span class=m>0000</span> <span class=m>0000</span> <span class=m>000010</span> <span class=m>0000</span> <span class=m>0000</span> <span class=m>0000</span> <span class=m>0000</span> <span class=m>0000</span> <span class=m>0040</span> <span class=m>0040</span> <span class=m>0040</span> 
</span></span><span class=line><span class=cl>～中略～
</span></span><span class=line><span class=cl>CMAR  PC   IR  ZNCOCT  R0   R1   R2   R3  LBUS RBUS ABUS SBUS 
</span></span><span class=line><span class=cl>0FD  000C EF00 <span class=m>000010</span> <span class=m>0007</span> <span class=m>0016</span> FFFD <span class=m>0005</span> <span class=m>0000</span> <span class=m>0000</span> <span class=m>0000</span> <span class=m>0000</span> 
</span></span><span class=line><span class=cl> CPU HALTED !
</span></span><span class=line><span class=cl>  <span class=m>259</span> STEPS USED
</span></span><span class=line><span class=cl>  T?.
</span></span><span class=line><span class=cl>&gt;&gt; dump
</span></span><span class=line><span class=cl>DUMP
</span></span><span class=line><span class=cl>  D?mm
</span></span><span class=line><span class=cl>    START ADRS ?000C
</span></span><span class=line><span class=cl>    END   ADRS ?000F
</span></span><span class=line><span class=cl>000C:01E7
</span></span><span class=line><span class=cl>000D:0014
</span></span><span class=line><span class=cl>000E:0005
</span></span><span class=line><span class=cl>000F:0016
</span></span><span class=line><span class=cl>  D?.
</span></span><span class=line><span class=cl>&gt;&gt; end
</span></span><span class=line><span class=cl>&gt;&gt;   MICRO-1 TERMINATED
</span></span></code></pre></div><p>　XN(アドレスが0x000Fの行)に487の大体の平方根22(0x0016)が格納されていますね．
大大大成功です．</p><h2 id=おわりに>おわりに<a href=#%e3%81%8a%e3%82%8f%e3%82%8a%e3%81%ab class=anchor aria-hidden=true><svg viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M15 7h3a5 5 0 015 5 5 5 0 01-5 5h-3m-6 0H6a5 5 0 01-5-5 5 5 0 015-5h3"/><line x1="8" y1="12" x2="16" y2="12"/></svg></a></h2><p>　Rust製の言語処理系ライブラリ（logosとchumsky）で遊んでいたら，いつの間にかアセンブラを書いていた．
何を言っているのか わからねーと思うが（以下略）</p><p>　MICRO-1が書かれた書籍は絶版だし，このまま授業も無くなってしまったら悲しいですね．
アセンブラはGitHubに置いておけばしばらくは残ると思うので，歴史的なアレコレとして誰か活用して下さい．</p><p>　P.S. サンプルプログラムのライセンスが不明なので，本家からダウンロードできなくなったらどうしよう&mldr;</p><p>おしまい</p></div></article><aside id=toc><div class=toc-title>Table of Contents</div><nav id=TableOfContents><ul><li><a href=#はじめに>はじめに</a></li><li><a href=#アセンブラ>アセンブラ</a><ul><li><a href=#一覧>一覧</a></li><li><a href=#特徴>特徴</a></li></ul></li><li><a href=#遊び方>遊び方</a></li><li><a href=#おわりに>おわりに</a></li></ul></nav></aside><div class="post-nav thin"><a class=next-post href=https://Kenta11.github.io/posts/2022-12-19-classic-engei/><span class=post-nav-label><svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-arrow-left"><line x1="19" y1="12" x2="5" y2="12"/><polyline points="12 19 5 12 12 5"/></svg>&nbsp;Newer</span><br><span>これまでに観た古典芸能の演目</span>
</a><a class=prev-post href=https://Kenta11.github.io/posts/2022-08-19-set-static-ip-jp/><span class=post-nav-label>Older&nbsp;<svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-arrow-right"><line x1="5" y1="12" x2="19" y2="12"/><polyline points="12 5 19 12 12 19"/></svg></span><br><span>Manjaroで静的IPアドレスを設定</span></a></div><div id=comments class=thin></div></main><footer id=site-footer class="section-inner thin animated fadeIn faster"><p>&copy; 2025 <a href=https://Kenta11.github.io/>Kenta Arai Webpage</a>
&#183; &#183; Made with <a href=https://gohugo.io/ target=_blank rel=noopener>Hugo</a>
&#183; Theme <a href=https://github.com/1bl4z3r/hermit-V2 target=_blank rel=noopener>Hermit-V2</a></p></footer><script async src=https://Kenta11.github.io/js/bundle.min.c7c384e4d29d192bbac6811ae4660bb01767194a5bea56baca77e8260f93ea16.js integrity="sha256-x8OE5NKdGSu6xoEa5GYLsBdnGUpb6la6ynfoJg+T6hY=" crossorigin=anonymous></script></body></html>